"use strict";var sa$4={is_first_launch:!1,launched:!1,_queue:[],mpshow_time:null,sa_referrer:"直接打开",query_share_depth:0,share_distinct_id:"",share_method:"",current_scene:"",inited:!1,para:{server_url:"",send_timeout:1e3,show_log:!1,allow_amend_share_path:!0,max_string_length:500,datasend_timeout:3e3,source_channel:[],batch_send:{send_timeout:6e3,max_length:6},preset_properties:{}},platform:"",lib:{version:"0.12.0",name:"MiniGame",method:"code"},properties:{$lib:"MiniGame",$lib_version:"0.12.0"},currentProps:{}};const _toString$3=Object.prototype.toString,_hasOwnProperty$3=Object.prototype.hasOwnProperty,indexOf$3=Array.prototype.indexOf,slice$3=Array.prototype.slice,_isArray$3=Array.prototype.isArray,forEach$3=Array.prototype.forEach,bind$3=Function.prototype.bind;function isUndefined$4(t){return void 0===t}function isString$4(t){return"[object String]"==_toString$3.call(t)}function isDate$4(t){return"[object Date]"==_toString$3.call(t)}function isBoolean$3(t){return"[object Boolean]"==_toString$3.call(t)}function isNumber$3(t){return"[object Number]"==_toString$3.call(t)&&/[\d\\.]+/.test(String(t))}function isJSONString$3(t){try{JSON.parse(t)}catch(t){return!1}return!0}function isObject$4(t){return null!=t&&"[object Object]"===_toString$3.call(t)}function isPlainObject$3(t){return"[object Object]"===_toString$3.call(t)}function isArray$4(t){return _isArray$3||"[object Array]"===_toString$3.call(t)}function isFuction$3(t){try{return/^\s*\bfunction\b/.test(t)}catch(t){return!1}}function isArguments$3(t){return!(!t||!_hasOwnProperty$3.call(t,"callee"))}function toString$3(t){return null==t?"":isArray$4(t)||isPlainObject$3(t)&&t.toString===_toString$3?JSON.stringify(t,null,2):String(t)}function each$4(t,e,r){if(null==t)return!1;if(forEach$3&&t.forEach===forEach$3)t.forEach(e,r);else if(t.length===+t.length){for(var s=0,n=t.length;s<n;s++)if(s in t&&e.call(r,t[s],s,t)==={})return!1}else for(var a in t)if(_hasOwnProperty$3.call(t,a)&&e.call(r,t[a],a,t)==={})return!1}function toArray$3(t,e){var r;return t?(r=[],t.toArray&&(r=t.toArray()),isArray$4(t)&&(r=slice$3.call(t)),isArguments$3(t)&&(r=slice$3.call(t)),r=values$3(t),e&&isNumber$3(e)?r.slice(e):r):[]}function values$3(t){var e=[];return null!=t&&each$4(t,function(t){e[e.length]=t}),e}function include$3(t,e){var r=!1;if(null!=t){if(indexOf$3&&t.indexOf===indexOf$3)return-1!=t.indexOf(e);each$4(t,function(t){if(r=r||t===e)return{}})}return r}function unique$3(t){for(var e,r=[],s={},n=0;n<t.length;n++)s[e=t[n]]||(s[e]=!0,r.push(e));return r}function formatDate$4(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())}function searchObjDate$4(r){(isObject$4(r)||isArray$4(r))&&each$4(r,function(t,e){isObject$4(t)||isArray$4(t)?searchObjDate$4(r[e]):isDate$4(t)&&(r[e]=formatDate$4(t))})}function trim$3(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function isFunction$4(t){return!!t&&("[object Function]"==(t=Object.prototype.toString.call(t))||"[object AsyncFunction]"==t||"[object GeneratorFunction]"==t)}function extend$4(r){return each$4(slice$3.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&(r[e]=t[e])}),r}function extend2Lev$3(r){return each$4(slice$3.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&null!==t[e]&&(isObject$4(t[e])&&isObject$4(r[e])?extend$4(r[e],t[e]):r[e]=t[e])}),r}function isEmptyObject$3(t){if(isObject$4(t)){for(var e in t)if(_hasOwnProperty$3.call(t,e))return!1;return!0}return!1}function deepCopy$3(t){var e={};return function t(e,r){for(var s in r){var n=r[s];isArray$4(n)?(e[s]=[],t(e[s],n)):isObject$4(n)?(e[s]={},t(e[s],n)):e[s]=n}}(e,t),e}function formatString$3(t){return t.length>sa$4.para.max_string_length?(sa$4.log("字符串长度超过限制，已经做截取--"+t),t.slice(0,sa$4.para.max_string_length)):t}function searchObjString$3(r){isObject$4(r)&&each$4(r,function(t,e){isObject$4(t)?searchObjString$3(r[e]):isString$4(t)&&(r[e]=formatString$3(t))})}function encodeDates$3(r){return each$4(r,function(t,e){isDate$4(t)?r[e]=formatDate$4(t):isObject$4(t)&&(r[e]=encodeDates$3(t))}),r}function utf8Encode$3(t){for(var e,r="",s=e=0,n=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,a=0;a<n;a++){var i=t.charCodeAt(a),o=null;i<128?e++:o=127<i&&i<2048?String.fromCharCode(i>>6|192,63&i|128):String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128),null!==o&&(s<e&&(r+=t.substring(s,e)),r+=o,s=e=a+1)}return s<e&&(r+=t.substring(s,t.length)),r}function base64Encode$3(t){var e,r,s,n,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,o=0,c="",u=[];if(!t)return t;for(t=utf8Encode$3(t);e=(n=t.charCodeAt(i++)<<16|t.charCodeAt(i++)<<8|t.charCodeAt(i++))>>12&63,r=n>>6&63,s=63&n,u[o++]=a.charAt(n>>18&63)+a.charAt(e)+a.charAt(r)+a.charAt(s),i<t.length;);switch(c=u.join(""),t.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}function _decodeURIComponent$3(e){var r="";try{r=decodeURIComponent(e)}catch(t){r=e}return r}var SOURCE_CHANNEL_STANDARD$3="utm_source utm_medium utm_campaign utm_content utm_term",LATEST_SOURCE_CHANNEL$3=["$latest_utm_source","$latest_utm_medium","$latest_utm_campaign","$latest_utm_content","$latest_utm_term","$latest_sa_utm"],LATEST_SHARE_INFO$3=["$latest_share_distinct_id","$latest_share_url_path","$latest_share_depth","$latest_share_method"],IDENTITY_KEY$3={EMAIL:"$identity_email",MOBILE:"$identity_mobile",LOGIN:"$identity_login_id"},RESERVE_CHANNEL$3=" utm_source utm_medium utm_campaign utm_content utm_term sa_utm ",meta$3={lib_version:"",launched:!1,lib_name:"",query_share_depth:0,page_show_time:Date.now(),mp_show_time:null,promise_list:[],current_scene:"",is_first_launch:!1,_queue:[],inited:!1,hasExeInit:!1,scene_prefix:"",share_distinct_id:"",sa_referrer:"直接打开",source_channel_standard:SOURCE_CHANNEL_STANDARD$3,latest_source_channel:LATEST_SOURCE_CHANNEL$3,latest_share_info:LATEST_SHARE_INFO$3};function getAppId$4(){var t=sa$4.system_api.getAppInfoSync();return t&&t.appId?t.appId:""}function getObjFromQuery$3(t){var e,t=t.split("?"),r={};return t&&t[1]?(each$4(t[1].split("&"),function(t){(e=t.split("="))[0]&&e[1]&&(r[e[0]]=e[1])}),r):{}}function getMixedQuery$3(t){var e,t=detectOptionQuery$3(t),r=t.scene,s=t.q,n=t.query;for(e in n)n[e]=_decodeURIComponent$3(n[e]);return r&&extend$4(n,getObjFromQuery$3(r=-1!==(r=_decodeURIComponent$3(r)).indexOf("?")?"?"+r.replace(/\?/g,""):"?"+r)),s&&extend$4(n,getObjFromQuery$3(_decodeURIComponent$3(s))),n}function detectOptionQuery$3(t){var e,r,s,n;return t&&isObject$4(t.query)?((e={}).query=extend$4({},t.query),isString$4(e.query.scene)&&(r=e.query,s=["utm_source","utm_content","utm_medium","utm_campaign","utm_term","sa_utm"].concat(sa$4.para.source_channel),s=new RegExp("("+s.join("|")+")%3D","i"),1===(n=Object.keys(r)).length)&&"scene"===n[0]&&s.test(r.scene)&&(e.scene=e.query.scene,delete e.query.scene),t.query.q&&t.query.scancode_time&&"101"===String(t.scene).slice(0,3)&&(e.q=String(e.query.q),delete e.query.q,delete e.query.scancode_time),e):{}}function setUtm$3(t,e){var r={},t=getMixedQuery$3(t),s=getCustomUtmFromQuery$3(t,"$","_","$"),t=getCustomUtmFromQuery$3(t,"$latest_","_latest_","$latest_");return r.pre1=s,r.pre2=t,extend$4(e,s),r}function setLatestChannel$3(t){isEmptyObject$3(t)||(!function(t,e){var r,s=!1;for(r in e)t[e[r]]&&(s=!0);return s}(t,LATEST_SOURCE_CHANNEL$3)||sa$4.clearAppRegister(LATEST_SOURCE_CHANNEL$3),sa$4.registerApp(t))}function getCustomUtmFromQuery$3(t,e,r,s){if(!isObject$4(t))return{};var n={};if(t.sa_utm)for(var a in t)"sa_utm"===a?n[s+a]=t[a]:include$3(sa$4.para.source_channel,a)&&(n[r+a]=t[a]);else for(var i in t)-1!==(" "+SOURCE_CHANNEL_STANDARD$3+" ").indexOf(" "+i+" ")?n[e+i]=t[i]:include$3(sa$4.para.source_channel,i)&&(n[r+i]=t[i]);return n}function existLatestUtm$3(){var e=!1;return each$4(LATEST_SOURCE_CHANNEL$3,function(t){sa$4.properties[t]&&(e=!0)}),e}function setQuery$3(t,r){var s;return t&&isObject$4(t)&&!isEmptyObject$3(t)?(s=[],each$4(t,function(t,e){"q"===e&&isString$4(t)&&0===t.indexOf("http")||s.push(r?e+"="+t:e+"="+_decodeURIComponent$3(t))}),s.join("&")):""}function getCurrentPage$3(){var t={};try{var e=isFunction$4(sa$4.system_api.getCurrentPages)?sa$4.system_api.getCurrentPages():getCurrentPages(),t=e[e.length-1]}catch(t){sa$4.log("getCurrentPage:"+t)}return t}function getCurrentPath$3(){var t="未取到";try{var e=getCurrentPage$3(),t=e?e.route:t}catch(t){sa$4.log("getCurrentPath:"+t)}return t}function isPresetIdKeys$3(t,e){var r,s=["$identity_anonymous_id"];for(r of s=isArray$4(e)?s.concat(e):s)if(r===t)return!0;return!1}var isSafeInteger$3=Number.isSafeInteger||function(t){return isInteger$3(t)&&Math.abs(t)<=Math.pow(2,53)-1},isInteger$3=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},check$3={checkKeyword:function(t){return/^((?!^distinct_id$|^original_id$|^device_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_group|^user_tag)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i.test(t)},checkIdLength:function(t){return!(255<String(t).length&&(sa$4.log("id 长度超过 255 个字符！"),1))}};function getOpenidNameByAppid$3(t){var e,r,s;return""!=t&&isString$4(t)?(r="$identity_",s="_openid",(e=getAppId$4())?r+t+"_"+e+s:r+t+s):(sa$4.log("error: 参数必须是有效值"),!1)}function validId$3(t){return!isString$4(t)&&!isNumber$3(t)||""===t||isNumber$3(t)&&(t=String(t),!/^\d+$/.test(t))?(sa$4.log("输入 ID 类型错误"),!1):!!check$3.checkIdLength(t)&&t}function isNewLoginId$3(t,e){return t!==sa$4.store._state.history_login_id.name||sa$4.store._state.history_login_id.value!==e}function isSameAndAnonymousID$3(t){var e=sa$4.store.getFirstId(),r=sa$4.store.getDistinctId();return e?t===e:t===r}function setUpperCase$3(t){return isString$4(t)?t.toLocaleUpperCase():t}function getIsFirstDay$3(){return!!("object"==typeof sa$4.store._state&&isNumber$3(sa$4.store._state.first_visit_day_time)&&sa$4.store._state.first_visit_day_time>(new Date).getTime())}function joinUrl$3(t,e){return!!t&&("未取到"===t?"未取到":e?t+"?"+e:t)}function getPath$3(t){return t=isString$4(t)?t.replace(/^\//,""):"取值异常"}function getAppProps$3(t){var e={};return t&&t.path&&(e.$url_path=getPath$3(t.path),e.$url_query=setQuery$3(t.query),e.$url=joinUrl$3(e.$url_path,e.$url_query)),e}function getPageProps$3(){var t=getCurrentPage$3(),e=getCurrentPath$3(),t=t.sensors_mp_url_query||"";return{$url_path:e,$url:joinUrl$3(e,t),$url_query:t}}function rot13defs$3(t){return rot13obfs$3(t=String(t),113)}function rot13obfs$3(t,e){e="number"==typeof e?e:13;for(var r=(t=String(t)).split(""),s=0,n=r.length;s<n;s++)r[s].charCodeAt(0)<126&&(r[s]=String.fromCharCode((r[s].charCodeAt(0)+e)%126));return r.join("")}var decodeURIComponent$1$3=_decodeURIComponent$3;function formatSystem$3(t){var e=t.toLowerCase();return"ios"===e?"iOS":"android"===e?"Android":t}var getRandomBasic$3=function(){var e=(new Date).getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();function getRandom$3(){if("function"==typeof Uint32Array){var t,e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),isObject$4(e)&&e.getRandomValues)return t=new Uint32Array(1),e.getRandomValues(t)[0]/Math.pow(2,32)}return getRandomBasic$3(1e19)/1e19}function getUUID$3(){return Date.now()+"-"+Math.floor(1e7*getRandom$3())+"-"+getRandom$3().toString(16).replace(".","")+"-"+String(31242*getRandom$3()).replace(".","").slice(0,8)}const _$3={getUUID:getUUID$3,formatSystem:formatSystem$3,indexOf:indexOf$3,slice:slice$3,forEach:forEach$3,bind:bind$3,_hasOwnProperty:_hasOwnProperty$3,_toString:_toString$3,isUndefined:isUndefined$4,isString:isString$4,isDate:isDate$4,isBoolean:isBoolean$3,isNumber:isNumber$3,isJSONString:isJSONString$3,isObject:isObject$4,isPlainObject:isPlainObject$3,isArray:isArray$4,isFuction:isFuction$3,isArguments:isArguments$3,toString:toString$3,unique:unique$3,include:include$3,values:values$3,toArray:toArray$3,each:each$4,formatDate:formatDate$4,searchObjDate:searchObjDate$4,utf8Encode:utf8Encode$3,decodeURIComponent:decodeURIComponent$1$3,encodeDates:encodeDates$3,base64Encode:base64Encode$3,trim:trim$3,isFunction:isFunction$4,extend:extend$4,extend2Lev:extend2Lev$3,isEmptyObject:isEmptyObject$3,searchObjString:searchObjString$3,formatString:formatString$3,setLatestChannel:setLatestChannel$3,getObjFromQuery:getObjFromQuery$3,getMixedQuery:getMixedQuery$3,detectOptionQuery:detectOptionQuery$3,setUtm:setUtm$3,getCustomUtmFromQuery:getCustomUtmFromQuery$3,existLatestUtm:existLatestUtm$3,setQuery:setQuery$3,getCurrentPage:getCurrentPage$3,getCurrentPath:getCurrentPath$3,rot13defs:rot13defs$3,rot13obfs:rot13obfs$3,isSafeInteger:isSafeInteger$3,isInteger:isInteger$3,isPresetIdKeys:isPresetIdKeys$3,deepCopy:deepCopy$3,check:check$3,getOpenidNameByAppid:getOpenidNameByAppid$3,validId:validId$3,isNewLoginId:isNewLoginId$3,isSameAndAnonymousID:isSameAndAnonymousID$3,setUpperCase:setUpperCase$3,getIsFirstDay:getIsFirstDay$3,getPageProps:getPageProps$3,getAppProps:getAppProps$3,getPath:getPath$3,joinUrl:joinUrl$3};function stripProperties$3(n){return isObject$4(n)&&each$4(n,function(e,r){var s;if(isArray$4(e)&&(s=[],each$4(e,function(t){if(isString$4(t))s.push(t);else if(isUndefined$4(t))s.push("null");else try{s.push(JSON.stringify(t))}catch(t){sa$4.log("您的数据 - "+r+":"+e+" - 的数组里的值有错误,已经将其删除")}}),n[r]=s),isObject$4(e))try{n[r]=JSON.stringify(e)}catch(t){delete n[r],sa$4.log("您的数据 - "+r+":"+e+" - 的数据值有错误,已经将其删除")}else isString$4(e)||isNumber$3(e)||isDate$4(e)||isBoolean$3(e)||isArray$4(e)||(sa$4.log("您的数据 - ",e,"-格式不满足要求，我们已经将其删除"),delete n[r])}),n}function parseSuperProperties$3(r){isObject$4(r)&&each$4(r,function(t,e){if(isFunction$4(t))try{r[e]=t(),isFunction$4(r[e])&&(sa$4.log("您的属性 - "+e+" 格式不满足要求，我们已经将其删除"),delete r[e])}catch(t){delete r[e],sa$4.log("您的属性 - "+e+" 抛出了异常，我们已经将其删除")}})}function batchRequest$3(t){var e,r;isArray$4(t.data)&&0<t.data.length?(e=Date.now(),r=sa$4.para.datasend_timeout,t.data.forEach(function(t){t._flush_time=e}),t.data=JSON.stringify(t.data),r={url:sa$4.para.server_url,method:"POST",dataType:"text",data:"data_list="+encodeURIComponent(base64Encode$3(t.data)),timeout:r,success:function(){t.success(t.len)},fail:function(){t.fail()}},sa$4.system_api.request(r)):t.success(t.len)}function onceSend$3(t){t._flush_time=Date.now();var e="",t=JSON.stringify(t),e=-1!==sa$4.para.server_url.indexOf("?")?sa$4.para.server_url+"&data="+encodeURIComponent(base64Encode$3(t)):sa$4.para.server_url+"?data="+encodeURIComponent(base64Encode$3(t)),t=sa$4.para.datasend_timeout;sa$4.system_api.request({url:e,dataType:"text",method:"GET",timeout:t})}var kit$3={batchRequest:batchRequest$3,onceSend:onceSend$3};function batchSend$3(){var t,e;sa$4.batch_state.sended&&0<(e=(t=100<=(t=sa$4.batch_state.mem).length?t.slice(0,100):t).length)&&(sa$4.batch_state.sended=!1,kit$3.batchRequest({data:t,len:e,success:batchRemove$3,fail:sendFail$3}))}function sendFail$3(){sa$4.batch_state.sended=!0,sa$4.batch_state.failTime++}function batchRemove$3(t){sa$4.batch_state.clear(t),sa$4.batch_state.sended=!0,sa$4.batch_state.changed=!0,batchWrite$3(),sa$4.batch_state.failTime=0}function batchWrite$3(){sa$4.batch_state.changed&&(sa$4.batch_state.is_first_batch_write&&(sa$4.batch_state.is_first_batch_write=!1,setTimeout(function(){batchSend$3()},1e3)),sa$4.batch_state.syncStorage)&&(sa$4.system_api.setStorageSync("sensors_prepare_data",sa$4.batch_state.mem),sa$4.batch_state.changed=!1)}function batchInterval$3(){!function t(){setTimeout(function(){batchWrite$3(),t()},1e3)}(),function t(){setTimeout(function(){batchSend$3(),t()},sa$4.para.batch_send.send_timeout*Math.pow(2,sa$4.batch_state.failTime))}()}function reportEvent$3(t){var e="sensors_",r="";t._flush_time=Date.now(),r=t.event?e+t.event:e+t.type,t.dataSource="sensors",sa$4.log("report_event, name: ",r,"-- key: ",t),__mp_private_api__.reportEvent(r,t)}function isValidListener$3(t){return"function"==typeof t||!(!t||"object"!=typeof t)&&isValidListener$3(t.listener)}sa$4.batch_state={mem:[],changed:!1,sended:!0,is_first_batch_write:!0,sync_storage:!1,failTime:0,getLength:function(){return this.mem.length},add:function(t){this.mem.push(t)},clear:function(t){this.mem.splice(0,t)}},sa$4.batchWrite=batchWrite$3,sa$4.prepareData=function(t){var e={distinct_id:sa$4.store.getDistinctId(),lib:{$lib:sa$4.lib.name,$lib_method:sa$4.lib.method,$lib_version:String(sa$4.lib.version)},properties:{}};if(isObject$4(sa$4.store._state.identities)&&(e.identities=sa$4.store._state.identities),"track_id_unbind"===t.type&&"$UnbindID"===t.event&&(e.identities=deepCopy$3(t.unbind_value),delete t.unbind_value),e=extend$4(e,sa$4.store.getUnionId(),t),isObject$4(t.properties)&&!isEmptyObject$3(t.properties)&&(e.properties=extend$4(e.properties,t.properties)),t.type&&"profile"===t.type.slice(0,7)||(e._track_id=Number(String(getRandom$3()).slice(2,5)+String(getRandom$3()).slice(2,4)+String(Date.now()).slice(-4)),e.properties=extend$4({},sa$4.properties,sa$4.store.getProps(),sa$4.currentProps,e.properties),"track"===t.type&&(e.properties.$is_first_day=getIsFirstDay$3())),e.properties.$time&&isDate$4(e.properties.$time)?(e.time=+e.properties.$time,delete e.properties.$time):e.time=+new Date,sa$4.ee.data.emit("beforeBuildCheck",e),parseSuperProperties$3(e.properties),searchObjDate$4(e),stripProperties$3(e.properties),searchObjString$3(e),sa$4.ee.data.emit("finalAdjustData",e),!sa$4.para.server_url)return!1;sa$4.log(e),sa$4.send(e)},sa$4.send=function(t){if(t._nocache=(String(getRandom$3())+String(getRandom$3())+String(getRandom$3())).slice(2,15),"sensorsdata2015_binance"===sa$4.storageName&&"native"===sa$4.para.data_report_type)return reportEvent$3(t),!1;sa$4.para.batch_send?(500<=sa$4.batch_state.getLength()&&(sa$4.log("数据量存储过大，有异常"),sa$4.batch_state.mem.shift()),sa$4.batch_state.add(t),sa$4.batch_state.changed=!0,sa$4.batch_state.getLength()>=sa$4.para.batch_send.max_length&&batchSend$3()):kit$3.onceSend(t)},sa$4.log=function(){if(sa$4.para.show_log&&"object"==typeof console&&console.log)try{var t=Array.prototype.slice.call(arguments);return console.log.apply(console,t)}catch(t){console.log(arguments[0])}},sa$4.track=function(t,e,r){sa$4.prepareData({type:"track",event:t,properties:e},r)},sa$4.setProfile=function(t){sa$4.prepareData({type:"profile_set",properties:t})},sa$4.setOnceProfile=function(t,e){sa$4.prepareData({type:"profile_set_once",properties:t},e)},sa$4.login=function(t){var e=sa$4.store.getFirstId(),r=sa$4.store.getDistinctId();t!==r&&(e||sa$4.store.set("first_id",r),sa$4.trackSignup(t,"$SignUp"))},sa$4.logout=function(t){var e=sa$4.store.getFirstId();e?(sa$4.store.set("first_id",""),!0===t?sa$4.store.set("distinct_id",getUUID$3()):sa$4.store.set("distinct_id",e)):sa$4.log("没有first_id，logout失败")},sa$4.identify=function(t){if("number"==typeof t)t=String(t);else if("string"!=typeof t)return!1;sa$4.store.getFirstId()?sa$4.store.set("first_id",t):sa$4.store.set("distinct_id",t)},sa$4.trackSignup=function(t,e,r){var s,n,a;isObject$4(t)?(s=t.id,n=t.event_name,a=t.id_name):(s=t,n=e),sa$4.store.set("distinct_id",s),t=a&&a!==IDENTITY_KEY$3.LOGIN?a+"+"+s:s,e=sa$4.store.getFirstId()||sa$4.store.getDistinctId(),sa$4.prepareData({original_id:e,distinct_id:t,type:"track_signup",event:n,properties:r})},sa$4.registerApp=function(t){isObject$4(t)&&!isEmptyObject$3(t)&&(sa$4.currentProps=extend$4(sa$4.currentProps,t))},sa$4.clearAppRegister=function(r){isArray$4(r)&&each$4(sa$4.currentProps,function(t,e){include$3(r,e)&&delete sa$4.currentProps[e]})},sa$4.register=function(t){isObject$4(t)&&!isEmptyObject$3(t)&&sa$4.store.setProps(t)},sa$4.clearAllRegister=function(){sa$4.store.setProps({},!0)},sa$4.use=function(t){var e=toArray$3(arguments,1);return e.unshift(this),isObject$4(t)&&isFunction$4(t.init)&&t.init.apply(t,e),t},sa$4.usePlugin=sa$4.use,sa$4.getServerUrl=function(){return sa$4.para.server_url},sa$4.registerPropertyPlugin=function(e){isFunction$4(e.properties)?e.isMatchedWithFilter&&!isFunction$4(e.isMatchedWithFilter)?sa$4.log("registerPropertyPlugin arguments error, isMatchedWithFilter must be function"):sa$4.ee.data.on("finalAdjustData",function(t){try{(!isFunction$4(e.isMatchedWithFilter)||e.isMatchedWithFilter(t))&&e.properties(t)}catch(t){sa$4.log("execute registerPropertyPlugin callback error:"+t)}}):sa$4.log("registerPropertyPlugin arguments error, properties must be function")};let EventEmitterBase$3=class{constructor(){this._events={}}on(t,e){if(!t||!e)return!1;if(isValidListener$3(e))return this._events[t]=this._events[t]||[],this._events[t].push("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prepend(t,e){if(!t||!e)return!1;if(isValidListener$3(e))return this._events[t]=this._events[t]||[],this._events[t].unshift("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prependOnce(t,e){return this.prepend(t,{listener:e,once:!0})}once(t,e){return this.on(t,{listener:e,once:!0})}off(t,e){var r=this._events[t];if(!r)return!1;if("number"==typeof e)r.splice(e,1);else if("function"==typeof e)for(var s=0,n=r.length;s<n;s++)r[s]&&r[s].listener===e&&r.splice(s,1);return this}emit(t,e){var r=this._events[t];if(!r)return!1;for(var s=0;s<r.length;s++){var n=r[s];n&&(n.listener.call(this,e||{}),n.once)&&this.off(t,s)}return this}removeAllListeners(t){t&&this._events[t]?this._events[t]=[]:this._events={}}listeners(t){return t&&"string"==typeof t?this._events[t]:this._events}},EventEmitterEx$3=class extends EventEmitterBase$3{constructor(){super(),this.cacheEvents=[],this.maxLen=20}replay(e,r){this.on(e,r),0<this.cacheEvents.length&&this.cacheEvents.forEach(function(t){t.type===e&&r.call(null,t.data)})}emit(t,e){super.emit.apply(this,arguments),this.cacheEvents.push({type:t,data:e}),this.cacheEvents.length>this.maxLen&&this.cacheEvents.shift()}};var ee$3={},eventEmitter$3=(ee$3.sdk=new EventEmitterEx$3,ee$3.data=new EventEmitterEx$3,function(){this.sub=[]}),eventSub$3=(eventEmitter$3.prototype={add:function(t){this.sub.push(t)},emit:function(e,r){this.sub.forEach(function(t){t.on(e,r)})}},function(t){sa$4.events.add(this),this._events=[],this.handle=t,this.ready=!1}),store$3=(eventSub$3.prototype={on:function(t,e){if(this.ready){if(isFunction$4(this.handle))try{this.handle(t,e)}catch(t){sa$4.log(t)}}else this._events.push({event:t,data:e})},isReady:function(){var e=this;e.ready=!0,e._events.forEach(function(t){if(isFunction$4(e.handle))try{e.handle(t.event,t.data)}catch(t){sa$4.log(t)}})}},sa$4.ee=ee$3,sa$4.meta=meta$3,sa$4.kit=kit$3,sa$4.modules={},sa$4.eventSub=eventSub$3,sa$4.events=new eventEmitter$3,sa$4.init=function(t){if(!0===meta$3.hasExeInit)return!1;t&&isObject$4(t)&&sa$4.setPara(t),meta$3.hasExeInit=!0,t&&isObject$4(t)&&sa$4.setPara(t),ee$3.sdk.emit("afterInitPara"),sa$4.store.init(),sa$4.system.init(),sa$4.para.batch_send&&(sa$4.system_api.getStorage("sensors_prepare_data",function(t){var e=[];t&&t.data&&isArray$4(t.data)&&(e=t.data,sa$4.batch_state.mem=e.concat(sa$4.batch_state.mem)),sa$4.batch_state.syncStorage=!0}),batchInterval$3())},sa$4.setPara=function(t){sa$4.para=extend2Lev$3(sa$4.para,t);var e=[];if(isArray$4(sa$4.para.source_channel))for(var r=sa$4.para.source_channel.length,s=0;s<r;s++)-1===RESERVE_CHANNEL$3.indexOf(" "+sa$4.para.source_channel[s]+" ")&&e.push(sa$4.para.source_channel[s]);sa$4.para.source_channel=e,"number"!=typeof sa$4.para.send_timeout&&(sa$4.para.send_timeout=1e3);var n={send_timeout:6e3,max_length:6};t&&t.datasend_timeout||sa$4.para.batch_send&&(sa$4.para.datasend_timeout=1e4),!0===sa$4.para.batch_send?sa$4.para.batch_send=extend$4({},n):isObject$4(sa$4.para.batch_send)&&(sa$4.para.batch_send=extend$4({},n,sa$4.para.batch_send)),sa$4.para.server_url?sa$4.para.preset_properties=isObject$4(sa$4.para.preset_properties)?sa$4.para.preset_properties:{}:sa$4.log("请使用 setPara() 方法设置 server_url 数据接收地址,详情可查看https://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0")},sa$4.checkInit=function(){!0===sa$4.system.inited&&!0===sa$4.store.inited&&(sa$4.inited=!0,0<sa$4._queue.length)&&(each$4(sa$4._queue,function(t){sa$4[t[0]].apply(sa$4,slice$3.call(t[1]))}),sa$4._queue=[])},each$4(["setProfile","setOnceProfile","track","login","logout","identify","registerApp","clearAppRegister"],function(t){var e=sa$4[t];sa$4[t]=function(){sa$4.inited?e.apply(sa$4,arguments):sa$4._queue.push([t,arguments])}}),{inited:!0,storageInfo:null,_state:{},toState:function(t){isObject$4(t)&&t.distinct_id?this._state=t:this.set("distinct_id",getUUID$3())},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getUnionId:function(){var t={},e=this._state.first_id,r=this._state.distinct_id;return e&&r?(t.login_id=r,t.anonymous_id=e):t.anonymous_id=r,t},getProps:function(){return this._state.props||{}},setProps:function(t,e){var r=this._state.props||{};e?this.set("props",t):(extend$4(r,t),this.set("props",r))},set:function(t,e){var r,s={};for(r in"string"==typeof t?s[t]=e:"object"==typeof t&&(s=t),this._state=this._state||{},s)this._state[r]=s[r];this.save()},save:function(){sa$4.system_api.setStorageSync(sa$4.storageName,this._state)},init:function(){var t,e=sa$4.system_api.getStorageSync(sa$4.storageName);e?this.toState(e):(meta$3.is_first_launch=!0,t=(e=new Date).getTime(),e.setHours(23),e.setMinutes(59),e.setSeconds(60),this.set({distinct_id:getUUID$3(),first_visit_time:t,first_visit_day_time:e.getTime()}),sa$4.setOnceProfile({$first_visit_time:new Date}))}});function getNetwork$2(){return new Promise(function(t){sa$4.system_api.getNetworkType({success(t){sa$4.properties.$network_type=setUpperCase$3(t.networkType)},fail(t){sa$4.log("获取网络状态信息失败： ",t)},complete(){t()}})})}function getSystemInfo$3(){return new Promise(t=>{sa$4.system_api.getSystemInfo({success(t){var e=sa$4.properties;isObject$4(t)&&(e.$manufacturer=t.brand,e.$model=t.model,e.$brand=setUpperCase$3(t.brand)||"",e.$screen_width=Number(t.screenWidth),e.$screen_height=Number(t.screenHeight),e.$os=formatSystem$3(t.platform),e.$os_version=-1<t.system.indexOf(" ")?t.system.split(" ")[1]:t.system,e.$mp_client_app_version=t.version||"",t=t.SDKVersion||"")&&(e.$mp_client_basic_library_version=t)},fail(t){sa$4.log("获取系统信息失败: ",t)},complete(){t()}})})}sa$4.store=store$3;var system$3={inited:!1,init:function(){var t=(new Date).getTimezoneOffset(),t=(isNumber$3(t)&&(sa$4.properties.$timezone_offset=t),getAppId$4()||sa$4.para.app_id||sa$4.para.appid),t=(t&&(sa$4.properties.$app_id=t),getNetwork$2()),e=getSystemInfo$3();Promise.all([t,e]).then(function(){sa$4.system.inited=!0,sa$4.checkInit()})}};function request$2(t){t.timeout&&(e=t.timeout,delete t.timeout);var e,r=sa$4.platform_obj.request(t);setTimeout(function(){try{isObject$4(r)&&isFunction$4(r.abort)&&r.abort()}catch(t){sa$4.log(t)}},e)}function getStorage$2(e,r){try{sa$4.platform_obj.getStorage({key:e,success:s,fail:s})}catch(t){try{sa$4.platform_obj.getStorage({key:e,success:s,fail:s})}catch(t){sa$4.log("获取 storage 失败！",t)}}function s(t){if(t&&t.data&&isJSONString$3(t.data))try{var e=JSON.parse(t.data);t.data=e}catch(t){sa$4.log("parse res.data 失败！",t)}r(t)}}function setStorage$2(e,t){var r;try{r=JSON.stringify(t)}catch(t){sa$4.log("序列化缓存对象失败！",t)}try{sa$4.platform_obj.setStorage({key:e,data:r})}catch(t){try{sa$4.platform_obj.setStorage({key:e,data:r})}catch(t){sa$4.log("设置 storage 失败: ",t)}}}function getStorageSync$3(e){var r="";try{r=sa$4.platform_obj.getStorageSync(e)}catch(t){try{r=sa$4.platform_obj.getStorageSync(e)}catch(t){sa$4.log("获取 storage 失败！")}}return r=isJSONString$3(r)?JSON.parse(r):r}function setStorageSync$3(t,e){var r;try{r=JSON.stringify(e)}catch(t){sa$4.log("序列化缓存对象失败！",t)}function s(){sa$4.platform_obj.setStorageSync(t,r)}try{s()}catch(t){sa$4.log("set Storage fail --",t);try{s()}catch(t){sa$4.log("set Storage fail again --",t)}}}function getNetworkType$2(){return sa$4.platform_obj.getNetworkType.apply(null,arguments)}function getSystemInfo$1$2(){return sa$4.platform_obj.getSystemInfo.apply(null,arguments)}function getAppId$1$2(){var t;if(isObject$4(t=sa$4.platform_obj.getAccountInfoSync?sa$4.platform_obj.getAccountInfoSync():t)&&isObject$4(t.miniProgram))return t.miniProgram}var compose$3={request:request$2,getStorage:getStorage$2,setStorage:setStorage$2,getStorageSync:getStorageSync$3,setStorageSync:setStorageSync$3,getAppInfoSync:getAppId$1$2,getNetworkType:getNetworkType$2,getSystemInfo:getSystemInfo$1$2},sa$3=(sa$4._=_$3,sa$4.system=system$3,sa$4.system_api=compose$3,sa$4.storageName="sd2015-qq-game",sa$4.properties.$data_ingestion_source=["QQGame"],"undefined"!=typeof qq&&(sa$4.platform_obj=qq),{is_first_launch:!1,launched:!1,_queue:[],mpshow_time:null,sa_referrer:"直接打开",query_share_depth:0,share_distinct_id:"",share_method:"",current_scene:"",inited:!1});sa$3.para={server_url:"",send_timeout:1e3,show_log:!1,allow_amend_share_path:!0,max_string_length:500,datasend_timeout:3e3,source_channel:[],batch_send:{send_timeout:6e3,max_length:6},preset_properties:{}},sa$3.platform="",sa$3.lib={version:"0.12.0",name:"MiniGame",method:"code"},sa$3.properties={$lib:"MiniGame",$lib_version:"0.12.0"},sa$3.currentProps={};const _toString$2=Object.prototype.toString,_hasOwnProperty$2=Object.prototype.hasOwnProperty,indexOf$2=Array.prototype.indexOf,slice$2=Array.prototype.slice,_isArray$2=Array.prototype.isArray,forEach$2=Array.prototype.forEach,bind$2=Function.prototype.bind;function isUndefined$3(t){return void 0===t}function isString$3(t){return"[object String]"==_toString$2.call(t)}function isDate$3(t){return"[object Date]"==_toString$2.call(t)}function isBoolean$2(t){return"[object Boolean]"==_toString$2.call(t)}function isNumber$2(t){return"[object Number]"==_toString$2.call(t)&&/[\d\\.]+/.test(String(t))}function isJSONString$2(t){try{JSON.parse(t)}catch(t){return!1}return!0}function isObject$3(t){return null!=t&&"[object Object]"===_toString$2.call(t)}function isPlainObject$2(t){return"[object Object]"===_toString$2.call(t)}function isArray$3(t){return _isArray$2||"[object Array]"===_toString$2.call(t)}function isFuction$2(t){try{return/^\s*\bfunction\b/.test(t)}catch(t){return!1}}function isArguments$2(t){return!(!t||!_hasOwnProperty$2.call(t,"callee"))}function toString$2(t){return null==t?"":isArray$3(t)||isPlainObject$2(t)&&t.toString===_toString$2?JSON.stringify(t,null,2):String(t)}function each$3(t,e,r){if(null==t)return!1;if(forEach$2&&t.forEach===forEach$2)t.forEach(e,r);else if(t.length===+t.length){for(var s=0,n=t.length;s<n;s++)if(s in t&&e.call(r,t[s],s,t)==={})return!1}else for(var a in t)if(_hasOwnProperty$2.call(t,a)&&e.call(r,t[a],a,t)==={})return!1}function toArray$2(t,e){var r;return t?(r=[],t.toArray&&(r=t.toArray()),isArray$3(t)&&(r=slice$2.call(t)),isArguments$2(t)&&(r=slice$2.call(t)),r=values$2(t),e&&isNumber$2(e)?r.slice(e):r):[]}function values$2(t){var e=[];return null!=t&&each$3(t,function(t){e[e.length]=t}),e}function include$2(t,e){var r=!1;if(null!=t){if(indexOf$2&&t.indexOf===indexOf$2)return-1!=t.indexOf(e);each$3(t,function(t){if(r=r||t===e)return{}})}return r}function unique$2(t){for(var e,r=[],s={},n=0;n<t.length;n++)s[e=t[n]]||(s[e]=!0,r.push(e));return r}function formatDate$3(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())}function searchObjDate$3(r){(isObject$3(r)||isArray$3(r))&&each$3(r,function(t,e){isObject$3(t)||isArray$3(t)?searchObjDate$3(r[e]):isDate$3(t)&&(r[e]=formatDate$3(t))})}function trim$2(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function isFunction$3(t){return!!t&&("[object Function]"==(t=Object.prototype.toString.call(t))||"[object AsyncFunction]"==t||"[object GeneratorFunction]"==t)}function extend$3(r){return each$3(slice$2.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&(r[e]=t[e])}),r}function extend2Lev$2(r){return each$3(slice$2.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&null!==t[e]&&(isObject$3(t[e])&&isObject$3(r[e])?extend$3(r[e],t[e]):r[e]=t[e])}),r}function isEmptyObject$2(t){if(isObject$3(t)){for(var e in t)if(_hasOwnProperty$2.call(t,e))return!1;return!0}return!1}function deepCopy$2(t){var e={};return function t(e,r){for(var s in r){var n=r[s];isArray$3(n)?(e[s]=[],t(e[s],n)):isObject$3(n)?(e[s]={},t(e[s],n)):e[s]=n}}(e,t),e}function formatString$2(t){return t.length>sa$3.para.max_string_length?(sa$3.log("字符串长度超过限制，已经做截取--"+t),t.slice(0,sa$3.para.max_string_length)):t}function searchObjString$2(r){isObject$3(r)&&each$3(r,function(t,e){isObject$3(t)?searchObjString$2(r[e]):isString$3(t)&&(r[e]=formatString$2(t))})}function encodeDates$2(r){return each$3(r,function(t,e){isDate$3(t)?r[e]=formatDate$3(t):isObject$3(t)&&(r[e]=encodeDates$2(t))}),r}function utf8Encode$2(t){for(var e,r="",s=e=0,n=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,a=0;a<n;a++){var i=t.charCodeAt(a),o=null;i<128?e++:o=127<i&&i<2048?String.fromCharCode(i>>6|192,63&i|128):String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128),null!==o&&(s<e&&(r+=t.substring(s,e)),r+=o,s=e=a+1)}return s<e&&(r+=t.substring(s,t.length)),r}function base64Encode$2(t){var e,r,s,n,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,o=0,c="",u=[];if(!t)return t;for(t=utf8Encode$2(t);e=(n=t.charCodeAt(i++)<<16|t.charCodeAt(i++)<<8|t.charCodeAt(i++))>>12&63,r=n>>6&63,s=63&n,u[o++]=a.charAt(n>>18&63)+a.charAt(e)+a.charAt(r)+a.charAt(s),i<t.length;);switch(c=u.join(""),t.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}function _decodeURIComponent$2(e){var r="";try{r=decodeURIComponent(e)}catch(t){r=e}return r}var SOURCE_CHANNEL_STANDARD$2="utm_source utm_medium utm_campaign utm_content utm_term",LATEST_SOURCE_CHANNEL$2=["$latest_utm_source","$latest_utm_medium","$latest_utm_campaign","$latest_utm_content","$latest_utm_term","$latest_sa_utm"],LATEST_SHARE_INFO$2=["$latest_share_distinct_id","$latest_share_url_path","$latest_share_depth","$latest_share_method"],IDENTITY_KEY$2={EMAIL:"$identity_email",MOBILE:"$identity_mobile",LOGIN:"$identity_login_id"},RESERVE_CHANNEL$2=" utm_source utm_medium utm_campaign utm_content utm_term sa_utm ",meta$2={lib_version:"",launched:!1,lib_name:"",query_share_depth:0,page_show_time:Date.now(),mp_show_time:null,promise_list:[],current_scene:"",is_first_launch:!1,_queue:[],inited:!1,hasExeInit:!1,scene_prefix:"",share_distinct_id:"",sa_referrer:"直接打开",source_channel_standard:SOURCE_CHANNEL_STANDARD$2,latest_source_channel:LATEST_SOURCE_CHANNEL$2,latest_share_info:LATEST_SHARE_INFO$2};function getAppId$3(){var t=sa$3.system_api.getAppInfoSync();return t&&t.appId?t.appId:""}function getObjFromQuery$2(t){var e,t=t.split("?"),r={};return t&&t[1]?(each$3(t[1].split("&"),function(t){(e=t.split("="))[0]&&e[1]&&(r[e[0]]=e[1])}),r):{}}function getMixedQuery$2(t){var e,t=detectOptionQuery$2(t),r=t.scene,s=t.q,n=t.query;for(e in n)n[e]=_decodeURIComponent$2(n[e]);return r&&extend$3(n,getObjFromQuery$2(r=-1!==(r=_decodeURIComponent$2(r)).indexOf("?")?"?"+r.replace(/\?/g,""):"?"+r)),s&&extend$3(n,getObjFromQuery$2(_decodeURIComponent$2(s))),n}function detectOptionQuery$2(t){var e,r,s,n;return t&&isObject$3(t.query)?((e={}).query=extend$3({},t.query),isString$3(e.query.scene)&&(r=e.query,s=["utm_source","utm_content","utm_medium","utm_campaign","utm_term","sa_utm"].concat(sa$3.para.source_channel),s=new RegExp("("+s.join("|")+")%3D","i"),1===(n=Object.keys(r)).length)&&"scene"===n[0]&&s.test(r.scene)&&(e.scene=e.query.scene,delete e.query.scene),t.query.q&&t.query.scancode_time&&"101"===String(t.scene).slice(0,3)&&(e.q=String(e.query.q),delete e.query.q,delete e.query.scancode_time),e):{}}function setUtm$2(t,e){var r={},t=getMixedQuery$2(t),s=getCustomUtmFromQuery$2(t,"$","_","$"),t=getCustomUtmFromQuery$2(t,"$latest_","_latest_","$latest_");return r.pre1=s,r.pre2=t,extend$3(e,s),r}function setLatestChannel$2(t){isEmptyObject$2(t)||(!function(t,e){var r,s=!1;for(r in e)t[e[r]]&&(s=!0);return s}(t,LATEST_SOURCE_CHANNEL$2)||sa$3.clearAppRegister(LATEST_SOURCE_CHANNEL$2),sa$3.registerApp(t))}function getCustomUtmFromQuery$2(t,e,r,s){if(!isObject$3(t))return{};var n={};if(t.sa_utm)for(var a in t)"sa_utm"===a?n[s+a]=t[a]:include$2(sa$3.para.source_channel,a)&&(n[r+a]=t[a]);else for(var i in t)-1!==(" "+SOURCE_CHANNEL_STANDARD$2+" ").indexOf(" "+i+" ")?n[e+i]=t[i]:include$2(sa$3.para.source_channel,i)&&(n[r+i]=t[i]);return n}function existLatestUtm$2(){var e=!1;return each$3(LATEST_SOURCE_CHANNEL$2,function(t){sa$3.properties[t]&&(e=!0)}),e}function setQuery$2(t,r){var s;return t&&isObject$3(t)&&!isEmptyObject$2(t)?(s=[],each$3(t,function(t,e){"q"===e&&isString$3(t)&&0===t.indexOf("http")||s.push(r?e+"="+t:e+"="+_decodeURIComponent$2(t))}),s.join("&")):""}function getCurrentPage$2(){var t={};try{var e=isFunction$3(sa$3.system_api.getCurrentPages)?sa$3.system_api.getCurrentPages():getCurrentPages(),t=e[e.length-1]}catch(t){sa$3.log("getCurrentPage:"+t)}return t}function getCurrentPath$2(){var t="未取到";try{var e=getCurrentPage$2(),t=e?e.route:t}catch(t){sa$3.log("getCurrentPath:"+t)}return t}function isPresetIdKeys$2(t,e){var r,s=["$identity_anonymous_id"];for(r of s=isArray$3(e)?s.concat(e):s)if(r===t)return!0;return!1}var isSafeInteger$2=Number.isSafeInteger||function(t){return isInteger$2(t)&&Math.abs(t)<=Math.pow(2,53)-1},isInteger$2=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},check$2={checkKeyword:function(t){return/^((?!^distinct_id$|^original_id$|^device_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_group|^user_tag)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i.test(t)},checkIdLength:function(t){return!(255<String(t).length&&(sa$3.log("id 长度超过 255 个字符！"),1))}};function getOpenidNameByAppid$2(t){var e,r,s;return""!=t&&isString$3(t)?(r="$identity_",s="_openid",(e=getAppId$3())?r+t+"_"+e+s:r+t+s):(sa$3.log("error: 参数必须是有效值"),!1)}function validId$2(t){return!isString$3(t)&&!isNumber$2(t)||""===t||isNumber$2(t)&&(t=String(t),!/^\d+$/.test(t))?(sa$3.log("输入 ID 类型错误"),!1):!!check$2.checkIdLength(t)&&t}function isNewLoginId$2(t,e){return t!==sa$3.store._state.history_login_id.name||sa$3.store._state.history_login_id.value!==e}function isSameAndAnonymousID$2(t){var e=sa$3.store.getFirstId(),r=sa$3.store.getDistinctId();return e?t===e:t===r}function setUpperCase$2(t){return isString$3(t)?t.toLocaleUpperCase():t}function getIsFirstDay$2(){return!!("object"==typeof sa$3.store._state&&isNumber$2(sa$3.store._state.first_visit_day_time)&&sa$3.store._state.first_visit_day_time>(new Date).getTime())}function joinUrl$2(t,e){return!!t&&("未取到"===t?"未取到":e?t+"?"+e:t)}function getPath$2(t){return t=isString$3(t)?t.replace(/^\//,""):"取值异常"}function getAppProps$2(t){var e={};return t&&t.path&&(e.$url_path=getPath$2(t.path),e.$url_query=setQuery$2(t.query),e.$url=joinUrl$2(e.$url_path,e.$url_query)),e}function getPageProps$2(){var t=getCurrentPage$2(),e=getCurrentPath$2(),t=t.sensors_mp_url_query||"";return{$url_path:e,$url:joinUrl$2(e,t),$url_query:t}}function rot13defs$2(t){return rot13obfs$2(t=String(t),113)}function rot13obfs$2(t,e){e="number"==typeof e?e:13;for(var r=(t=String(t)).split(""),s=0,n=r.length;s<n;s++)r[s].charCodeAt(0)<126&&(r[s]=String.fromCharCode((r[s].charCodeAt(0)+e)%126));return r.join("")}var decodeURIComponent$1$2=_decodeURIComponent$2;function formatSystem$2(t){var e=t.toLowerCase();return"ios"===e?"iOS":"android"===e?"Android":t}var getRandomBasic$2=function(){var e=(new Date).getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();function getRandom$2(){if("function"==typeof Uint32Array){var t,e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),isObject$3(e)&&e.getRandomValues)return t=new Uint32Array(1),e.getRandomValues(t)[0]/Math.pow(2,32)}return getRandomBasic$2(1e19)/1e19}function getUUID$2(){return Date.now()+"-"+Math.floor(1e7*getRandom$2())+"-"+getRandom$2().toString(16).replace(".","")+"-"+String(31242*getRandom$2()).replace(".","").slice(0,8)}const _$2={getUUID:getUUID$2,formatSystem:formatSystem$2,indexOf:indexOf$2,slice:slice$2,forEach:forEach$2,bind:bind$2,_hasOwnProperty:_hasOwnProperty$2,_toString:_toString$2,isUndefined:isUndefined$3,isString:isString$3,isDate:isDate$3,isBoolean:isBoolean$2,isNumber:isNumber$2,isJSONString:isJSONString$2,isObject:isObject$3,isPlainObject:isPlainObject$2,isArray:isArray$3,isFuction:isFuction$2,isArguments:isArguments$2,toString:toString$2,unique:unique$2,include:include$2,values:values$2,toArray:toArray$2,each:each$3,formatDate:formatDate$3,searchObjDate:searchObjDate$3,utf8Encode:utf8Encode$2,decodeURIComponent:decodeURIComponent$1$2,encodeDates:encodeDates$2,base64Encode:base64Encode$2,trim:trim$2,isFunction:isFunction$3,extend:extend$3,extend2Lev:extend2Lev$2,isEmptyObject:isEmptyObject$2,searchObjString:searchObjString$2,formatString:formatString$2,setLatestChannel:setLatestChannel$2,getObjFromQuery:getObjFromQuery$2,getMixedQuery:getMixedQuery$2,detectOptionQuery:detectOptionQuery$2,setUtm:setUtm$2,getCustomUtmFromQuery:getCustomUtmFromQuery$2,existLatestUtm:existLatestUtm$2,setQuery:setQuery$2,getCurrentPage:getCurrentPage$2,getCurrentPath:getCurrentPath$2,rot13defs:rot13defs$2,rot13obfs:rot13obfs$2,isSafeInteger:isSafeInteger$2,isInteger:isInteger$2,isPresetIdKeys:isPresetIdKeys$2,deepCopy:deepCopy$2,check:check$2,getOpenidNameByAppid:getOpenidNameByAppid$2,validId:validId$2,isNewLoginId:isNewLoginId$2,isSameAndAnonymousID:isSameAndAnonymousID$2,setUpperCase:setUpperCase$2,getIsFirstDay:getIsFirstDay$2,getPageProps:getPageProps$2,getAppProps:getAppProps$2,getPath:getPath$2,joinUrl:joinUrl$2};function stripProperties$2(n){return isObject$3(n)&&each$3(n,function(e,r){var s;if(isArray$3(e)&&(s=[],each$3(e,function(t){if(isString$3(t))s.push(t);else if(isUndefined$3(t))s.push("null");else try{s.push(JSON.stringify(t))}catch(t){sa$3.log("您的数据 - "+r+":"+e+" - 的数组里的值有错误,已经将其删除")}}),n[r]=s),isObject$3(e))try{n[r]=JSON.stringify(e)}catch(t){delete n[r],sa$3.log("您的数据 - "+r+":"+e+" - 的数据值有错误,已经将其删除")}else isString$3(e)||isNumber$2(e)||isDate$3(e)||isBoolean$2(e)||isArray$3(e)||(sa$3.log("您的数据 - ",e,"-格式不满足要求，我们已经将其删除"),delete n[r])}),n}function parseSuperProperties$2(r){isObject$3(r)&&each$3(r,function(t,e){if(isFunction$3(t))try{r[e]=t(),isFunction$3(r[e])&&(sa$3.log("您的属性 - "+e+" 格式不满足要求，我们已经将其删除"),delete r[e])}catch(t){delete r[e],sa$3.log("您的属性 - "+e+" 抛出了异常，我们已经将其删除")}})}function batchRequest$2(t){var e,r;isArray$3(t.data)&&0<t.data.length?(e=Date.now(),r=sa$3.para.datasend_timeout,t.data.forEach(function(t){t._flush_time=e}),t.data=JSON.stringify(t.data),r={url:sa$3.para.server_url,method:"POST",dataType:"text",data:"data_list="+encodeURIComponent(base64Encode$2(t.data)),timeout:r,success:function(){t.success(t.len)},fail:function(){t.fail()}},sa$3.system_api.request(r)):t.success(t.len)}function onceSend$2(t){t._flush_time=Date.now();var e="",t=JSON.stringify(t),e=-1!==sa$3.para.server_url.indexOf("?")?sa$3.para.server_url+"&data="+encodeURIComponent(base64Encode$2(t)):sa$3.para.server_url+"?data="+encodeURIComponent(base64Encode$2(t)),t=sa$3.para.datasend_timeout;sa$3.system_api.request({url:e,dataType:"text",method:"GET",timeout:t})}var kit$2={batchRequest:batchRequest$2,onceSend:onceSend$2};function batchSend$2(){var t,e;sa$3.batch_state.sended&&0<(e=(t=100<=(t=sa$3.batch_state.mem).length?t.slice(0,100):t).length)&&(sa$3.batch_state.sended=!1,kit$2.batchRequest({data:t,len:e,success:batchRemove$2,fail:sendFail$2}))}function sendFail$2(){sa$3.batch_state.sended=!0,sa$3.batch_state.failTime++}function batchRemove$2(t){sa$3.batch_state.clear(t),sa$3.batch_state.sended=!0,sa$3.batch_state.changed=!0,batchWrite$2(),sa$3.batch_state.failTime=0}function batchWrite$2(){sa$3.batch_state.changed&&(sa$3.batch_state.is_first_batch_write&&(sa$3.batch_state.is_first_batch_write=!1,setTimeout(function(){batchSend$2()},1e3)),sa$3.batch_state.syncStorage)&&(sa$3.system_api.setStorageSync("sensors_prepare_data",sa$3.batch_state.mem),sa$3.batch_state.changed=!1)}function batchInterval$2(){!function t(){setTimeout(function(){batchWrite$2(),t()},1e3)}(),function t(){setTimeout(function(){batchSend$2(),t()},sa$3.para.batch_send.send_timeout*Math.pow(2,sa$3.batch_state.failTime))}()}function reportEvent$2(t){var e="sensors_",r="";t._flush_time=Date.now(),r=t.event?e+t.event:e+t.type,t.dataSource="sensors",sa$3.log("report_event, name: ",r,"-- key: ",t),__mp_private_api__.reportEvent(r,t)}function isValidListener$2(t){return"function"==typeof t||!(!t||"object"!=typeof t)&&isValidListener$2(t.listener)}sa$3.batch_state={mem:[],changed:!1,sended:!0,is_first_batch_write:!0,sync_storage:!1,failTime:0,getLength:function(){return this.mem.length},add:function(t){this.mem.push(t)},clear:function(t){this.mem.splice(0,t)}},sa$3.batchWrite=batchWrite$2,sa$3.prepareData=function(t){var e={distinct_id:sa$3.store.getDistinctId(),lib:{$lib:sa$3.lib.name,$lib_method:sa$3.lib.method,$lib_version:String(sa$3.lib.version)},properties:{}};if(isObject$3(sa$3.store._state.identities)&&(e.identities=sa$3.store._state.identities),"track_id_unbind"===t.type&&"$UnbindID"===t.event&&(e.identities=deepCopy$2(t.unbind_value),delete t.unbind_value),e=extend$3(e,sa$3.store.getUnionId(),t),isObject$3(t.properties)&&!isEmptyObject$2(t.properties)&&(e.properties=extend$3(e.properties,t.properties)),t.type&&"profile"===t.type.slice(0,7)||(e._track_id=Number(String(getRandom$2()).slice(2,5)+String(getRandom$2()).slice(2,4)+String(Date.now()).slice(-4)),e.properties=extend$3({},sa$3.properties,sa$3.store.getProps(),sa$3.currentProps,e.properties),"track"===t.type&&(e.properties.$is_first_day=getIsFirstDay$2())),e.properties.$time&&isDate$3(e.properties.$time)?(e.time=+e.properties.$time,delete e.properties.$time):e.time=+new Date,sa$3.ee.data.emit("beforeBuildCheck",e),parseSuperProperties$2(e.properties),searchObjDate$3(e),stripProperties$2(e.properties),searchObjString$2(e),sa$3.ee.data.emit("finalAdjustData",e),!sa$3.para.server_url)return!1;sa$3.log(e),sa$3.send(e)},sa$3.send=function(t){if(t._nocache=(String(getRandom$2())+String(getRandom$2())+String(getRandom$2())).slice(2,15),"sensorsdata2015_binance"===sa$3.storageName&&"native"===sa$3.para.data_report_type)return reportEvent$2(t),!1;sa$3.para.batch_send?(500<=sa$3.batch_state.getLength()&&(sa$3.log("数据量存储过大，有异常"),sa$3.batch_state.mem.shift()),sa$3.batch_state.add(t),sa$3.batch_state.changed=!0,sa$3.batch_state.getLength()>=sa$3.para.batch_send.max_length&&batchSend$2()):kit$2.onceSend(t)},sa$3.log=function(){if(sa$3.para.show_log&&"object"==typeof console&&console.log)try{var t=Array.prototype.slice.call(arguments);return console.log.apply(console,t)}catch(t){console.log(arguments[0])}},sa$3.track=function(t,e,r){sa$3.prepareData({type:"track",event:t,properties:e},r)},sa$3.setProfile=function(t){sa$3.prepareData({type:"profile_set",properties:t})},sa$3.setOnceProfile=function(t,e){sa$3.prepareData({type:"profile_set_once",properties:t},e)},sa$3.login=function(t){var e=sa$3.store.getFirstId(),r=sa$3.store.getDistinctId();t!==r&&(e||sa$3.store.set("first_id",r),sa$3.trackSignup(t,"$SignUp"))},sa$3.logout=function(t){var e=sa$3.store.getFirstId();e?(sa$3.store.set("first_id",""),!0===t?sa$3.store.set("distinct_id",getUUID$2()):sa$3.store.set("distinct_id",e)):sa$3.log("没有first_id，logout失败")},sa$3.identify=function(t){if("number"==typeof t)t=String(t);else if("string"!=typeof t)return!1;sa$3.store.getFirstId()?sa$3.store.set("first_id",t):sa$3.store.set("distinct_id",t)},sa$3.trackSignup=function(t,e,r){var s,n,a;isObject$3(t)?(s=t.id,n=t.event_name,a=t.id_name):(s=t,n=e),sa$3.store.set("distinct_id",s),t=a&&a!==IDENTITY_KEY$2.LOGIN?a+"+"+s:s,e=sa$3.store.getFirstId()||sa$3.store.getDistinctId(),sa$3.prepareData({original_id:e,distinct_id:t,type:"track_signup",event:n,properties:r})},sa$3.registerApp=function(t){isObject$3(t)&&!isEmptyObject$2(t)&&(sa$3.currentProps=extend$3(sa$3.currentProps,t))},sa$3.clearAppRegister=function(r){isArray$3(r)&&each$3(sa$3.currentProps,function(t,e){include$2(r,e)&&delete sa$3.currentProps[e]})},sa$3.register=function(t){isObject$3(t)&&!isEmptyObject$2(t)&&sa$3.store.setProps(t)},sa$3.clearAllRegister=function(){sa$3.store.setProps({},!0)},sa$3.use=function(t){var e=toArray$2(arguments,1);return e.unshift(this),isObject$3(t)&&isFunction$3(t.init)&&t.init.apply(t,e),t},sa$3.usePlugin=sa$3.use,sa$3.getServerUrl=function(){return sa$3.para.server_url},sa$3.registerPropertyPlugin=function(e){isFunction$3(e.properties)?e.isMatchedWithFilter&&!isFunction$3(e.isMatchedWithFilter)?sa$3.log("registerPropertyPlugin arguments error, isMatchedWithFilter must be function"):sa$3.ee.data.on("finalAdjustData",function(t){try{(!isFunction$3(e.isMatchedWithFilter)||e.isMatchedWithFilter(t))&&e.properties(t)}catch(t){sa$3.log("execute registerPropertyPlugin callback error:"+t)}}):sa$3.log("registerPropertyPlugin arguments error, properties must be function")};let EventEmitterBase$2=class{constructor(){this._events={}}on(t,e){if(!t||!e)return!1;if(isValidListener$2(e))return this._events[t]=this._events[t]||[],this._events[t].push("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prepend(t,e){if(!t||!e)return!1;if(isValidListener$2(e))return this._events[t]=this._events[t]||[],this._events[t].unshift("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prependOnce(t,e){return this.prepend(t,{listener:e,once:!0})}once(t,e){return this.on(t,{listener:e,once:!0})}off(t,e){var r=this._events[t];if(!r)return!1;if("number"==typeof e)r.splice(e,1);else if("function"==typeof e)for(var s=0,n=r.length;s<n;s++)r[s]&&r[s].listener===e&&r.splice(s,1);return this}emit(t,e){var r=this._events[t];if(!r)return!1;for(var s=0;s<r.length;s++){var n=r[s];n&&(n.listener.call(this,e||{}),n.once)&&this.off(t,s)}return this}removeAllListeners(t){t&&this._events[t]?this._events[t]=[]:this._events={}}listeners(t){return t&&"string"==typeof t?this._events[t]:this._events}},EventEmitterEx$2=class extends EventEmitterBase$2{constructor(){super(),this.cacheEvents=[],this.maxLen=20}replay(e,r){this.on(e,r),0<this.cacheEvents.length&&this.cacheEvents.forEach(function(t){t.type===e&&r.call(null,t.data)})}emit(t,e){super.emit.apply(this,arguments),this.cacheEvents.push({type:t,data:e}),this.cacheEvents.length>this.maxLen&&this.cacheEvents.shift()}};var ee$2={},eventEmitter$2=(ee$2.sdk=new EventEmitterEx$2,ee$2.data=new EventEmitterEx$2,function(){this.sub=[]}),eventSub$2=(eventEmitter$2.prototype={add:function(t){this.sub.push(t)},emit:function(e,r){this.sub.forEach(function(t){t.on(e,r)})}},function(t){sa$3.events.add(this),this._events=[],this.handle=t,this.ready=!1}),store$2=(eventSub$2.prototype={on:function(t,e){if(this.ready){if(isFunction$3(this.handle))try{this.handle(t,e)}catch(t){sa$3.log(t)}}else this._events.push({event:t,data:e})},isReady:function(){var e=this;e.ready=!0,e._events.forEach(function(t){if(isFunction$3(e.handle))try{e.handle(t.event,t.data)}catch(t){sa$3.log(t)}})}},sa$3.ee=ee$2,sa$3.meta=meta$2,sa$3.kit=kit$2,sa$3.modules={},sa$3.eventSub=eventSub$2,sa$3.events=new eventEmitter$2,sa$3.init=function(t){if(!0===meta$2.hasExeInit)return!1;t&&isObject$3(t)&&sa$3.setPara(t),meta$2.hasExeInit=!0,t&&isObject$3(t)&&sa$3.setPara(t),ee$2.sdk.emit("afterInitPara"),sa$3.store.init(),sa$3.system.init(),sa$3.para.batch_send&&(sa$3.system_api.getStorage("sensors_prepare_data",function(t){var e=[];t&&t.data&&isArray$3(t.data)&&(e=t.data,sa$3.batch_state.mem=e.concat(sa$3.batch_state.mem)),sa$3.batch_state.syncStorage=!0}),batchInterval$2())},sa$3.setPara=function(t){sa$3.para=extend2Lev$2(sa$3.para,t);var e=[];if(isArray$3(sa$3.para.source_channel))for(var r=sa$3.para.source_channel.length,s=0;s<r;s++)-1===RESERVE_CHANNEL$2.indexOf(" "+sa$3.para.source_channel[s]+" ")&&e.push(sa$3.para.source_channel[s]);sa$3.para.source_channel=e,"number"!=typeof sa$3.para.send_timeout&&(sa$3.para.send_timeout=1e3);var n={send_timeout:6e3,max_length:6};t&&t.datasend_timeout||sa$3.para.batch_send&&(sa$3.para.datasend_timeout=1e4),!0===sa$3.para.batch_send?sa$3.para.batch_send=extend$3({},n):isObject$3(sa$3.para.batch_send)&&(sa$3.para.batch_send=extend$3({},n,sa$3.para.batch_send)),sa$3.para.server_url?sa$3.para.preset_properties=isObject$3(sa$3.para.preset_properties)?sa$3.para.preset_properties:{}:sa$3.log("请使用 setPara() 方法设置 server_url 数据接收地址,详情可查看https://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0")},sa$3.checkInit=function(){!0===sa$3.system.inited&&!0===sa$3.store.inited&&(sa$3.inited=!0,0<sa$3._queue.length)&&(each$3(sa$3._queue,function(t){sa$3[t[0]].apply(sa$3,slice$2.call(t[1]))}),sa$3._queue=[])},each$3(["setProfile","setOnceProfile","track","login","logout","identify","registerApp","clearAppRegister"],function(t){var e=sa$3[t];sa$3[t]=function(){sa$3.inited?e.apply(sa$3,arguments):sa$3._queue.push([t,arguments])}}),{inited:!0,storageInfo:null,_state:{},toState:function(t){isObject$3(t)&&t.distinct_id?this._state=t:this.set("distinct_id",getUUID$2())},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getUnionId:function(){var t={},e=this._state.first_id,r=this._state.distinct_id;return e&&r?(t.login_id=r,t.anonymous_id=e):t.anonymous_id=r,t},getProps:function(){return this._state.props||{}},setProps:function(t,e){var r=this._state.props||{};e?this.set("props",t):(extend$3(r,t),this.set("props",r))},set:function(t,e){var r,s={};for(r in"string"==typeof t?s[t]=e:"object"==typeof t&&(s=t),this._state=this._state||{},s)this._state[r]=s[r];this.save()},save:function(){sa$3.system_api.setStorageSync(sa$3.storageName,this._state)},init:function(){var t,e=sa$3.system_api.getStorageSync(sa$3.storageName);e?this.toState(e):(meta$2.is_first_launch=!0,t=(e=new Date).getTime(),e.setHours(23),e.setMinutes(59),e.setSeconds(60),this.set({distinct_id:getUUID$2(),first_visit_time:t,first_visit_day_time:e.getTime()}),sa$3.setOnceProfile({$first_visit_time:new Date}))}});function getNetwork$1(){return new Promise(function(t){sa$3.system_api.getNetworkType({success(t){sa$3.properties.$network_type=setUpperCase$2(t.networkType)},fail(t){sa$3.log("获取网络状态信息失败： ",t)},complete(){t()}})})}function getSystemInfo$2(){return new Promise(t=>{sa$3.system_api.getSystemInfo({success(t){var e=sa$3.properties;isObject$3(t)&&(e.$manufacturer=t.brand,e.$model=t.model,e.$brand=setUpperCase$2(t.brand)||"",e.$screen_width=Number(t.screenWidth),e.$screen_height=Number(t.screenHeight),e.$os=formatSystem$2(t.platform),e.$os_version=-1<t.system.indexOf(" ")?t.system.split(" ")[1]:t.system,e.$mp_client_app_version=t.version||"",t=t.SDKVersion||"")&&(e.$mp_client_basic_library_version=t)},fail(t){sa$3.log("获取系统信息失败: ",t)},complete(){t()}})})}sa$3.store=store$2;var system$2={inited:!1,init:function(){var t=(new Date).getTimezoneOffset(),t=(isNumber$2(t)&&(sa$3.properties.$timezone_offset=t),getAppId$3()||sa$3.para.app_id||sa$3.para.appid),t=(t&&(sa$3.properties.$app_id=t),getNetwork$1()),e=getSystemInfo$2();Promise.all([t,e]).then(function(){sa$3.system.inited=!0,sa$3.checkInit()})}};function request$1(t){t.timeout&&(e=t.timeout,delete t.timeout);var e,r=sa$3.platform_obj.request(t);setTimeout(function(){try{isObject$3(r)&&isFunction$3(r.abort)&&r.abort()}catch(t){sa$3.log(t)}},e)}function getStorage$1(e,r){try{sa$3.platform_obj.getStorage({key:e,success:s,fail:s})}catch(t){try{sa$3.platform_obj.getStorage({key:e,success:s,fail:s})}catch(t){sa$3.log("获取 storage 失败！",t)}}function s(t){if(t&&t.data&&isJSONString$2(t.data))try{var e=JSON.parse(t.data);t.data=e}catch(t){sa$3.log("parse res.data 失败！",t)}r(t)}}function setStorage$1(e,t){var r;try{r=JSON.stringify(t)}catch(t){sa$3.log("序列化缓存对象失败！",t)}try{sa$3.platform_obj.setStorage({key:e,data:r})}catch(t){try{sa$3.platform_obj.setStorage({key:e,data:r})}catch(t){sa$3.log("设置 storage 失败: ",t)}}}function getStorageSync$2(e){var r="";try{r=sa$3.platform_obj.getStorageSync(e)}catch(t){try{r=sa$3.platform_obj.getStorageSync(e)}catch(t){sa$3.log("获取 storage 失败！")}}return r=isJSONString$2(r)?JSON.parse(r):r}function setStorageSync$2(t,e){var r;try{r=JSON.stringify(e)}catch(t){sa$3.log("序列化缓存对象失败！",t)}function s(){sa$3.platform_obj.setStorageSync(t,r)}try{s()}catch(t){sa$3.log("set Storage fail --",t);try{s()}catch(t){sa$3.log("set Storage fail again --",t)}}}function getNetworkType$1(){return sa$3.platform_obj.getNetworkType.apply(null,arguments)}function getSystemInfo$1$1(){return sa$3.platform_obj.getSystemInfo.apply(null,arguments)}function getAppId$1$1(){var t;if(isObject$3(t=sa$3.platform_obj.getAccountInfoSync?sa$3.platform_obj.getAccountInfoSync():t)&&isObject$3(t.miniProgram))return t.miniProgram}var compose$2={request:request$1,getStorage:getStorage$1,setStorage:setStorage$1,getStorageSync:getStorageSync$2,setStorageSync:setStorageSync$2,getAppInfoSync:getAppId$1$1,getNetworkType:getNetworkType$1,getSystemInfo:getSystemInfo$1$1},sa$2=(sa$3._=_$2,sa$3.system_api=compose$2,sa$3.system=system$2,sa$3.properties.$data_ingestion_source=["WechatGame"],sa$3.storageName="sd2015-wechat-game","undefined"!=typeof wx&&(sa$3.platform_obj=wx),{is_first_launch:!1,launched:!1,_queue:[],mpshow_time:null,sa_referrer:"直接打开",query_share_depth:0,share_distinct_id:"",share_method:"",current_scene:"",inited:!1});sa$2.para={server_url:"",send_timeout:1e3,show_log:!1,allow_amend_share_path:!0,max_string_length:500,datasend_timeout:3e3,source_channel:[],batch_send:{send_timeout:6e3,max_length:6},preset_properties:{}},sa$2.platform="",sa$2.lib={version:"0.12.0",name:"MiniGame",method:"code"},sa$2.properties={$lib:"MiniGame",$lib_version:"0.12.0"},sa$2.currentProps={};const _toString$1=Object.prototype.toString,_hasOwnProperty$1=Object.prototype.hasOwnProperty,indexOf$1=Array.prototype.indexOf,slice$1=Array.prototype.slice,_isArray$1=Array.prototype.isArray,forEach$1=Array.prototype.forEach,bind$1=Function.prototype.bind;function isUndefined$2(t){return void 0===t}function isString$2(t){return"[object String]"==_toString$1.call(t)}function isDate$2(t){return"[object Date]"==_toString$1.call(t)}function isBoolean$1(t){return"[object Boolean]"==_toString$1.call(t)}function isNumber$1(t){return"[object Number]"==_toString$1.call(t)&&/[\d\\.]+/.test(String(t))}function isJSONString$1(t){try{JSON.parse(t)}catch(t){return!1}return!0}function isObject$2(t){return null!=t&&"[object Object]"===_toString$1.call(t)}function isPlainObject$1(t){return"[object Object]"===_toString$1.call(t)}function isArray$2(t){return _isArray$1||"[object Array]"===_toString$1.call(t)}function isFuction$1(t){try{return/^\s*\bfunction\b/.test(t)}catch(t){return!1}}function isArguments$1(t){return!(!t||!_hasOwnProperty$1.call(t,"callee"))}function toString$1(t){return null==t?"":isArray$2(t)||isPlainObject$1(t)&&t.toString===_toString$1?JSON.stringify(t,null,2):String(t)}function each$2(t,e,r){if(null==t)return!1;if(forEach$1&&t.forEach===forEach$1)t.forEach(e,r);else if(t.length===+t.length){for(var s=0,n=t.length;s<n;s++)if(s in t&&e.call(r,t[s],s,t)==={})return!1}else for(var a in t)if(_hasOwnProperty$1.call(t,a)&&e.call(r,t[a],a,t)==={})return!1}function toArray$1(t,e){var r;return t?(r=[],t.toArray&&(r=t.toArray()),isArray$2(t)&&(r=slice$1.call(t)),isArguments$1(t)&&(r=slice$1.call(t)),r=values$1(t),e&&isNumber$1(e)?r.slice(e):r):[]}function values$1(t){var e=[];return null!=t&&each$2(t,function(t){e[e.length]=t}),e}function include$1(t,e){var r=!1;if(null!=t){if(indexOf$1&&t.indexOf===indexOf$1)return-1!=t.indexOf(e);each$2(t,function(t){if(r=r||t===e)return{}})}return r}function unique$1(t){for(var e,r=[],s={},n=0;n<t.length;n++)s[e=t[n]]||(s[e]=!0,r.push(e));return r}function formatDate$2(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())}function searchObjDate$2(r){(isObject$2(r)||isArray$2(r))&&each$2(r,function(t,e){isObject$2(t)||isArray$2(t)?searchObjDate$2(r[e]):isDate$2(t)&&(r[e]=formatDate$2(t))})}function trim$1(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function isFunction$2(t){return!!t&&("[object Function]"==(t=Object.prototype.toString.call(t))||"[object AsyncFunction]"==t||"[object GeneratorFunction]"==t)}function extend$2(r){return each$2(slice$1.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&(r[e]=t[e])}),r}function extend2Lev$1(r){return each$2(slice$1.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&null!==t[e]&&(isObject$2(t[e])&&isObject$2(r[e])?extend$2(r[e],t[e]):r[e]=t[e])}),r}function isEmptyObject$1(t){if(isObject$2(t)){for(var e in t)if(_hasOwnProperty$1.call(t,e))return!1;return!0}return!1}function deepCopy$1(t){var e={};return function t(e,r){for(var s in r){var n=r[s];isArray$2(n)?(e[s]=[],t(e[s],n)):isObject$2(n)?(e[s]={},t(e[s],n)):e[s]=n}}(e,t),e}function formatString$1(t){return t.length>sa$2.para.max_string_length?(sa$2.log("字符串长度超过限制，已经做截取--"+t),t.slice(0,sa$2.para.max_string_length)):t}function searchObjString$1(r){isObject$2(r)&&each$2(r,function(t,e){isObject$2(t)?searchObjString$1(r[e]):isString$2(t)&&(r[e]=formatString$1(t))})}function encodeDates$1(r){return each$2(r,function(t,e){isDate$2(t)?r[e]=formatDate$2(t):isObject$2(t)&&(r[e]=encodeDates$1(t))}),r}function utf8Encode$1(t){for(var e,r="",s=e=0,n=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,a=0;a<n;a++){var i=t.charCodeAt(a),o=null;i<128?e++:o=127<i&&i<2048?String.fromCharCode(i>>6|192,63&i|128):String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128),null!==o&&(s<e&&(r+=t.substring(s,e)),r+=o,s=e=a+1)}return s<e&&(r+=t.substring(s,t.length)),r}function base64Encode$1(t){var e,r,s,n,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,o=0,c="",u=[];if(!t)return t;for(t=utf8Encode$1(t);e=(n=t.charCodeAt(i++)<<16|t.charCodeAt(i++)<<8|t.charCodeAt(i++))>>12&63,r=n>>6&63,s=63&n,u[o++]=a.charAt(n>>18&63)+a.charAt(e)+a.charAt(r)+a.charAt(s),i<t.length;);switch(c=u.join(""),t.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}function _decodeURIComponent$1(e){var r="";try{r=decodeURIComponent(e)}catch(t){r=e}return r}var SOURCE_CHANNEL_STANDARD$1="utm_source utm_medium utm_campaign utm_content utm_term",LATEST_SOURCE_CHANNEL$1=["$latest_utm_source","$latest_utm_medium","$latest_utm_campaign","$latest_utm_content","$latest_utm_term","$latest_sa_utm"],LATEST_SHARE_INFO$1=["$latest_share_distinct_id","$latest_share_url_path","$latest_share_depth","$latest_share_method"],IDENTITY_KEY$1={EMAIL:"$identity_email",MOBILE:"$identity_mobile",LOGIN:"$identity_login_id"},RESERVE_CHANNEL$1=" utm_source utm_medium utm_campaign utm_content utm_term sa_utm ",meta$1={lib_version:"",launched:!1,lib_name:"",query_share_depth:0,page_show_time:Date.now(),mp_show_time:null,promise_list:[],current_scene:"",is_first_launch:!1,_queue:[],inited:!1,hasExeInit:!1,scene_prefix:"",share_distinct_id:"",sa_referrer:"直接打开",source_channel_standard:SOURCE_CHANNEL_STANDARD$1,latest_source_channel:LATEST_SOURCE_CHANNEL$1,latest_share_info:LATEST_SHARE_INFO$1};function getAppId$2(){var t=sa$2.system_api.getAppInfoSync();return t&&t.appId?t.appId:""}function getObjFromQuery$1(t){var e,t=t.split("?"),r={};return t&&t[1]?(each$2(t[1].split("&"),function(t){(e=t.split("="))[0]&&e[1]&&(r[e[0]]=e[1])}),r):{}}function getMixedQuery$1(t){var e,t=detectOptionQuery$1(t),r=t.scene,s=t.q,n=t.query;for(e in n)n[e]=_decodeURIComponent$1(n[e]);return r&&extend$2(n,getObjFromQuery$1(r=-1!==(r=_decodeURIComponent$1(r)).indexOf("?")?"?"+r.replace(/\?/g,""):"?"+r)),s&&extend$2(n,getObjFromQuery$1(_decodeURIComponent$1(s))),n}function detectOptionQuery$1(t){var e,r,s,n;return t&&isObject$2(t.query)?((e={}).query=extend$2({},t.query),isString$2(e.query.scene)&&(r=e.query,s=["utm_source","utm_content","utm_medium","utm_campaign","utm_term","sa_utm"].concat(sa$2.para.source_channel),s=new RegExp("("+s.join("|")+")%3D","i"),1===(n=Object.keys(r)).length)&&"scene"===n[0]&&s.test(r.scene)&&(e.scene=e.query.scene,delete e.query.scene),t.query.q&&t.query.scancode_time&&"101"===String(t.scene).slice(0,3)&&(e.q=String(e.query.q),delete e.query.q,delete e.query.scancode_time),e):{}}function setUtm$1(t,e){var r={},t=getMixedQuery$1(t),s=getCustomUtmFromQuery$1(t,"$","_","$"),t=getCustomUtmFromQuery$1(t,"$latest_","_latest_","$latest_");return r.pre1=s,r.pre2=t,extend$2(e,s),r}function setLatestChannel$1(t){isEmptyObject$1(t)||(!function(t,e){var r,s=!1;for(r in e)t[e[r]]&&(s=!0);return s}(t,LATEST_SOURCE_CHANNEL$1)||sa$2.clearAppRegister(LATEST_SOURCE_CHANNEL$1),sa$2.registerApp(t))}function getCustomUtmFromQuery$1(t,e,r,s){if(!isObject$2(t))return{};var n={};if(t.sa_utm)for(var a in t)"sa_utm"===a?n[s+a]=t[a]:include$1(sa$2.para.source_channel,a)&&(n[r+a]=t[a]);else for(var i in t)-1!==(" "+SOURCE_CHANNEL_STANDARD$1+" ").indexOf(" "+i+" ")?n[e+i]=t[i]:include$1(sa$2.para.source_channel,i)&&(n[r+i]=t[i]);return n}function existLatestUtm$1(){var e=!1;return each$2(LATEST_SOURCE_CHANNEL$1,function(t){sa$2.properties[t]&&(e=!0)}),e}function setQuery$1(t,r){var s;return t&&isObject$2(t)&&!isEmptyObject$1(t)?(s=[],each$2(t,function(t,e){"q"===e&&isString$2(t)&&0===t.indexOf("http")||s.push(r?e+"="+t:e+"="+_decodeURIComponent$1(t))}),s.join("&")):""}function getCurrentPage$1(){var t={};try{var e=isFunction$2(sa$2.system_api.getCurrentPages)?sa$2.system_api.getCurrentPages():getCurrentPages(),t=e[e.length-1]}catch(t){sa$2.log("getCurrentPage:"+t)}return t}function getCurrentPath$1(){var t="未取到";try{var e=getCurrentPage$1(),t=e?e.route:t}catch(t){sa$2.log("getCurrentPath:"+t)}return t}function isPresetIdKeys$1(t,e){var r,s=["$identity_anonymous_id"];for(r of s=isArray$2(e)?s.concat(e):s)if(r===t)return!0;return!1}var isSafeInteger$1=Number.isSafeInteger||function(t){return isInteger$1(t)&&Math.abs(t)<=Math.pow(2,53)-1},isInteger$1=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},check$1={checkKeyword:function(t){return/^((?!^distinct_id$|^original_id$|^device_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_group|^user_tag)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i.test(t)},checkIdLength:function(t){return!(255<String(t).length&&(sa$2.log("id 长度超过 255 个字符！"),1))}};function getOpenidNameByAppid$1(t){var e,r,s;return""!=t&&isString$2(t)?(r="$identity_",s="_openid",(e=getAppId$2())?r+t+"_"+e+s:r+t+s):(sa$2.log("error: 参数必须是有效值"),!1)}function validId$1(t){return!isString$2(t)&&!isNumber$1(t)||""===t||isNumber$1(t)&&(t=String(t),!/^\d+$/.test(t))?(sa$2.log("输入 ID 类型错误"),!1):!!check$1.checkIdLength(t)&&t}function isNewLoginId$1(t,e){return t!==sa$2.store._state.history_login_id.name||sa$2.store._state.history_login_id.value!==e}function isSameAndAnonymousID$1(t){var e=sa$2.store.getFirstId(),r=sa$2.store.getDistinctId();return e?t===e:t===r}function setUpperCase$1(t){return isString$2(t)?t.toLocaleUpperCase():t}function getIsFirstDay$1(){return!!("object"==typeof sa$2.store._state&&isNumber$1(sa$2.store._state.first_visit_day_time)&&sa$2.store._state.first_visit_day_time>(new Date).getTime())}function joinUrl$1(t,e){return!!t&&("未取到"===t?"未取到":e?t+"?"+e:t)}function getPath$1(t){return t=isString$2(t)?t.replace(/^\//,""):"取值异常"}function getAppProps$1(t){var e={};return t&&t.path&&(e.$url_path=getPath$1(t.path),e.$url_query=setQuery$1(t.query),e.$url=joinUrl$1(e.$url_path,e.$url_query)),e}function getPageProps$1(){var t=getCurrentPage$1(),e=getCurrentPath$1(),t=t.sensors_mp_url_query||"";return{$url_path:e,$url:joinUrl$1(e,t),$url_query:t}}function rot13defs$1(t){return rot13obfs$1(t=String(t),113)}function rot13obfs$1(t,e){e="number"==typeof e?e:13;for(var r=(t=String(t)).split(""),s=0,n=r.length;s<n;s++)r[s].charCodeAt(0)<126&&(r[s]=String.fromCharCode((r[s].charCodeAt(0)+e)%126));return r.join("")}var decodeURIComponent$1$1=_decodeURIComponent$1;function formatSystem$1(t){var e=t.toLowerCase();return"ios"===e?"iOS":"android"===e?"Android":t}var getRandomBasic$1=function(){var e=(new Date).getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();function getRandom$1(){if("function"==typeof Uint32Array){var t,e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),isObject$2(e)&&e.getRandomValues)return t=new Uint32Array(1),e.getRandomValues(t)[0]/Math.pow(2,32)}return getRandomBasic$1(1e19)/1e19}function getUUID$1(){return Date.now()+"-"+Math.floor(1e7*getRandom$1())+"-"+getRandom$1().toString(16).replace(".","")+"-"+String(31242*getRandom$1()).replace(".","").slice(0,8)}const _$1={getUUID:getUUID$1,formatSystem:formatSystem$1,indexOf:indexOf$1,slice:slice$1,forEach:forEach$1,bind:bind$1,_hasOwnProperty:_hasOwnProperty$1,_toString:_toString$1,isUndefined:isUndefined$2,isString:isString$2,isDate:isDate$2,isBoolean:isBoolean$1,isNumber:isNumber$1,isJSONString:isJSONString$1,isObject:isObject$2,isPlainObject:isPlainObject$1,isArray:isArray$2,isFuction:isFuction$1,isArguments:isArguments$1,toString:toString$1,unique:unique$1,include:include$1,values:values$1,toArray:toArray$1,each:each$2,formatDate:formatDate$2,searchObjDate:searchObjDate$2,utf8Encode:utf8Encode$1,decodeURIComponent:decodeURIComponent$1$1,encodeDates:encodeDates$1,base64Encode:base64Encode$1,trim:trim$1,isFunction:isFunction$2,extend:extend$2,extend2Lev:extend2Lev$1,isEmptyObject:isEmptyObject$1,searchObjString:searchObjString$1,formatString:formatString$1,setLatestChannel:setLatestChannel$1,getObjFromQuery:getObjFromQuery$1,getMixedQuery:getMixedQuery$1,detectOptionQuery:detectOptionQuery$1,setUtm:setUtm$1,getCustomUtmFromQuery:getCustomUtmFromQuery$1,existLatestUtm:existLatestUtm$1,setQuery:setQuery$1,getCurrentPage:getCurrentPage$1,getCurrentPath:getCurrentPath$1,rot13defs:rot13defs$1,rot13obfs:rot13obfs$1,isSafeInteger:isSafeInteger$1,isInteger:isInteger$1,isPresetIdKeys:isPresetIdKeys$1,deepCopy:deepCopy$1,check:check$1,getOpenidNameByAppid:getOpenidNameByAppid$1,validId:validId$1,isNewLoginId:isNewLoginId$1,isSameAndAnonymousID:isSameAndAnonymousID$1,setUpperCase:setUpperCase$1,getIsFirstDay:getIsFirstDay$1,getPageProps:getPageProps$1,getAppProps:getAppProps$1,getPath:getPath$1,joinUrl:joinUrl$1};function stripProperties$1(n){return isObject$2(n)&&each$2(n,function(e,r){var s;if(isArray$2(e)&&(s=[],each$2(e,function(t){if(isString$2(t))s.push(t);else if(isUndefined$2(t))s.push("null");else try{s.push(JSON.stringify(t))}catch(t){sa$2.log("您的数据 - "+r+":"+e+" - 的数组里的值有错误,已经将其删除")}}),n[r]=s),isObject$2(e))try{n[r]=JSON.stringify(e)}catch(t){delete n[r],sa$2.log("您的数据 - "+r+":"+e+" - 的数据值有错误,已经将其删除")}else isString$2(e)||isNumber$1(e)||isDate$2(e)||isBoolean$1(e)||isArray$2(e)||(sa$2.log("您的数据 - ",e,"-格式不满足要求，我们已经将其删除"),delete n[r])}),n}function parseSuperProperties$1(r){isObject$2(r)&&each$2(r,function(t,e){if(isFunction$2(t))try{r[e]=t(),isFunction$2(r[e])&&(sa$2.log("您的属性 - "+e+" 格式不满足要求，我们已经将其删除"),delete r[e])}catch(t){delete r[e],sa$2.log("您的属性 - "+e+" 抛出了异常，我们已经将其删除")}})}function batchRequest$1(t){var e,r;isArray$2(t.data)&&0<t.data.length?(e=Date.now(),r=sa$2.para.datasend_timeout,t.data.forEach(function(t){t._flush_time=e}),t.data=JSON.stringify(t.data),r={url:sa$2.para.server_url,method:"POST",dataType:"text",data:"data_list="+encodeURIComponent(base64Encode$1(t.data)),timeout:r,success:function(){t.success(t.len)},fail:function(){t.fail()}},sa$2.system_api.request(r)):t.success(t.len)}function onceSend$1(t){t._flush_time=Date.now();var e="",t=JSON.stringify(t),e=-1!==sa$2.para.server_url.indexOf("?")?sa$2.para.server_url+"&data="+encodeURIComponent(base64Encode$1(t)):sa$2.para.server_url+"?data="+encodeURIComponent(base64Encode$1(t)),t=sa$2.para.datasend_timeout;sa$2.system_api.request({url:e,dataType:"text",method:"GET",timeout:t})}var kit$1={batchRequest:batchRequest$1,onceSend:onceSend$1};function batchSend$1(){var t,e;sa$2.batch_state.sended&&0<(e=(t=100<=(t=sa$2.batch_state.mem).length?t.slice(0,100):t).length)&&(sa$2.batch_state.sended=!1,kit$1.batchRequest({data:t,len:e,success:batchRemove$1,fail:sendFail$1}))}function sendFail$1(){sa$2.batch_state.sended=!0,sa$2.batch_state.failTime++}function batchRemove$1(t){sa$2.batch_state.clear(t),sa$2.batch_state.sended=!0,sa$2.batch_state.changed=!0,batchWrite$1(),sa$2.batch_state.failTime=0}function batchWrite$1(){sa$2.batch_state.changed&&(sa$2.batch_state.is_first_batch_write&&(sa$2.batch_state.is_first_batch_write=!1,setTimeout(function(){batchSend$1()},1e3)),sa$2.batch_state.syncStorage)&&(sa$2.system_api.setStorageSync("sensors_prepare_data",sa$2.batch_state.mem),sa$2.batch_state.changed=!1)}function batchInterval$1(){!function t(){setTimeout(function(){batchWrite$1(),t()},1e3)}(),function t(){setTimeout(function(){batchSend$1(),t()},sa$2.para.batch_send.send_timeout*Math.pow(2,sa$2.batch_state.failTime))}()}function reportEvent$1(t){var e="sensors_",r="";t._flush_time=Date.now(),r=t.event?e+t.event:e+t.type,t.dataSource="sensors",sa$2.log("report_event, name: ",r,"-- key: ",t),__mp_private_api__.reportEvent(r,t)}function isValidListener$1(t){return"function"==typeof t||!(!t||"object"!=typeof t)&&isValidListener$1(t.listener)}sa$2.batch_state={mem:[],changed:!1,sended:!0,is_first_batch_write:!0,sync_storage:!1,failTime:0,getLength:function(){return this.mem.length},add:function(t){this.mem.push(t)},clear:function(t){this.mem.splice(0,t)}},sa$2.batchWrite=batchWrite$1,sa$2.prepareData=function(t){var e={distinct_id:sa$2.store.getDistinctId(),lib:{$lib:sa$2.lib.name,$lib_method:sa$2.lib.method,$lib_version:String(sa$2.lib.version)},properties:{}};if(isObject$2(sa$2.store._state.identities)&&(e.identities=sa$2.store._state.identities),"track_id_unbind"===t.type&&"$UnbindID"===t.event&&(e.identities=deepCopy$1(t.unbind_value),delete t.unbind_value),e=extend$2(e,sa$2.store.getUnionId(),t),isObject$2(t.properties)&&!isEmptyObject$1(t.properties)&&(e.properties=extend$2(e.properties,t.properties)),t.type&&"profile"===t.type.slice(0,7)||(e._track_id=Number(String(getRandom$1()).slice(2,5)+String(getRandom$1()).slice(2,4)+String(Date.now()).slice(-4)),e.properties=extend$2({},sa$2.properties,sa$2.store.getProps(),sa$2.currentProps,e.properties),"track"===t.type&&(e.properties.$is_first_day=getIsFirstDay$1())),e.properties.$time&&isDate$2(e.properties.$time)?(e.time=+e.properties.$time,delete e.properties.$time):e.time=+new Date,sa$2.ee.data.emit("beforeBuildCheck",e),parseSuperProperties$1(e.properties),searchObjDate$2(e),stripProperties$1(e.properties),searchObjString$1(e),sa$2.ee.data.emit("finalAdjustData",e),!sa$2.para.server_url)return!1;sa$2.log(e),sa$2.send(e)},sa$2.send=function(t){if(t._nocache=(String(getRandom$1())+String(getRandom$1())+String(getRandom$1())).slice(2,15),"sensorsdata2015_binance"===sa$2.storageName&&"native"===sa$2.para.data_report_type)return reportEvent$1(t),!1;sa$2.para.batch_send?(500<=sa$2.batch_state.getLength()&&(sa$2.log("数据量存储过大，有异常"),sa$2.batch_state.mem.shift()),sa$2.batch_state.add(t),sa$2.batch_state.changed=!0,sa$2.batch_state.getLength()>=sa$2.para.batch_send.max_length&&batchSend$1()):kit$1.onceSend(t)},sa$2.log=function(){if(sa$2.para.show_log&&"object"==typeof console&&console.log)try{var t=Array.prototype.slice.call(arguments);return console.log.apply(console,t)}catch(t){console.log(arguments[0])}},sa$2.track=function(t,e,r){sa$2.prepareData({type:"track",event:t,properties:e},r)},sa$2.setProfile=function(t){sa$2.prepareData({type:"profile_set",properties:t})},sa$2.setOnceProfile=function(t,e){sa$2.prepareData({type:"profile_set_once",properties:t},e)},sa$2.login=function(t){var e=sa$2.store.getFirstId(),r=sa$2.store.getDistinctId();t!==r&&(e||sa$2.store.set("first_id",r),sa$2.trackSignup(t,"$SignUp"))},sa$2.logout=function(t){var e=sa$2.store.getFirstId();e?(sa$2.store.set("first_id",""),!0===t?sa$2.store.set("distinct_id",getUUID$1()):sa$2.store.set("distinct_id",e)):sa$2.log("没有first_id，logout失败")},sa$2.identify=function(t){if("number"==typeof t)t=String(t);else if("string"!=typeof t)return!1;sa$2.store.getFirstId()?sa$2.store.set("first_id",t):sa$2.store.set("distinct_id",t)},sa$2.trackSignup=function(t,e,r){var s,n,a;isObject$2(t)?(s=t.id,n=t.event_name,a=t.id_name):(s=t,n=e),sa$2.store.set("distinct_id",s),t=a&&a!==IDENTITY_KEY$1.LOGIN?a+"+"+s:s,e=sa$2.store.getFirstId()||sa$2.store.getDistinctId(),sa$2.prepareData({original_id:e,distinct_id:t,type:"track_signup",event:n,properties:r})},sa$2.registerApp=function(t){isObject$2(t)&&!isEmptyObject$1(t)&&(sa$2.currentProps=extend$2(sa$2.currentProps,t))},sa$2.clearAppRegister=function(r){isArray$2(r)&&each$2(sa$2.currentProps,function(t,e){include$1(r,e)&&delete sa$2.currentProps[e]})},sa$2.register=function(t){isObject$2(t)&&!isEmptyObject$1(t)&&sa$2.store.setProps(t)},sa$2.clearAllRegister=function(){sa$2.store.setProps({},!0)},sa$2.use=function(t){var e=toArray$1(arguments,1);return e.unshift(this),isObject$2(t)&&isFunction$2(t.init)&&t.init.apply(t,e),t},sa$2.usePlugin=sa$2.use,sa$2.getServerUrl=function(){return sa$2.para.server_url},sa$2.registerPropertyPlugin=function(e){isFunction$2(e.properties)?e.isMatchedWithFilter&&!isFunction$2(e.isMatchedWithFilter)?sa$2.log("registerPropertyPlugin arguments error, isMatchedWithFilter must be function"):sa$2.ee.data.on("finalAdjustData",function(t){try{(!isFunction$2(e.isMatchedWithFilter)||e.isMatchedWithFilter(t))&&e.properties(t)}catch(t){sa$2.log("execute registerPropertyPlugin callback error:"+t)}}):sa$2.log("registerPropertyPlugin arguments error, properties must be function")};let EventEmitterBase$1=class{constructor(){this._events={}}on(t,e){if(!t||!e)return!1;if(isValidListener$1(e))return this._events[t]=this._events[t]||[],this._events[t].push("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prepend(t,e){if(!t||!e)return!1;if(isValidListener$1(e))return this._events[t]=this._events[t]||[],this._events[t].unshift("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prependOnce(t,e){return this.prepend(t,{listener:e,once:!0})}once(t,e){return this.on(t,{listener:e,once:!0})}off(t,e){var r=this._events[t];if(!r)return!1;if("number"==typeof e)r.splice(e,1);else if("function"==typeof e)for(var s=0,n=r.length;s<n;s++)r[s]&&r[s].listener===e&&r.splice(s,1);return this}emit(t,e){var r=this._events[t];if(!r)return!1;for(var s=0;s<r.length;s++){var n=r[s];n&&(n.listener.call(this,e||{}),n.once)&&this.off(t,s)}return this}removeAllListeners(t){t&&this._events[t]?this._events[t]=[]:this._events={}}listeners(t){return t&&"string"==typeof t?this._events[t]:this._events}},EventEmitterEx$1=class extends EventEmitterBase$1{constructor(){super(),this.cacheEvents=[],this.maxLen=20}replay(e,r){this.on(e,r),0<this.cacheEvents.length&&this.cacheEvents.forEach(function(t){t.type===e&&r.call(null,t.data)})}emit(t,e){super.emit.apply(this,arguments),this.cacheEvents.push({type:t,data:e}),this.cacheEvents.length>this.maxLen&&this.cacheEvents.shift()}};var ee$1={},eventEmitter$1=(ee$1.sdk=new EventEmitterEx$1,ee$1.data=new EventEmitterEx$1,function(){this.sub=[]}),eventSub$1=(eventEmitter$1.prototype={add:function(t){this.sub.push(t)},emit:function(e,r){this.sub.forEach(function(t){t.on(e,r)})}},function(t){sa$2.events.add(this),this._events=[],this.handle=t,this.ready=!1}),store$1=(eventSub$1.prototype={on:function(t,e){if(this.ready){if(isFunction$2(this.handle))try{this.handle(t,e)}catch(t){sa$2.log(t)}}else this._events.push({event:t,data:e})},isReady:function(){var e=this;e.ready=!0,e._events.forEach(function(t){if(isFunction$2(e.handle))try{e.handle(t.event,t.data)}catch(t){sa$2.log(t)}})}},sa$2.ee=ee$1,sa$2.meta=meta$1,sa$2.kit=kit$1,sa$2.modules={},sa$2.eventSub=eventSub$1,sa$2.events=new eventEmitter$1,sa$2.init=function(t){if(!0===meta$1.hasExeInit)return!1;t&&isObject$2(t)&&sa$2.setPara(t),meta$1.hasExeInit=!0,t&&isObject$2(t)&&sa$2.setPara(t),ee$1.sdk.emit("afterInitPara"),sa$2.store.init(),sa$2.system.init(),sa$2.para.batch_send&&(sa$2.system_api.getStorage("sensors_prepare_data",function(t){var e=[];t&&t.data&&isArray$2(t.data)&&(e=t.data,sa$2.batch_state.mem=e.concat(sa$2.batch_state.mem)),sa$2.batch_state.syncStorage=!0}),batchInterval$1())},sa$2.setPara=function(t){sa$2.para=extend2Lev$1(sa$2.para,t);var e=[];if(isArray$2(sa$2.para.source_channel))for(var r=sa$2.para.source_channel.length,s=0;s<r;s++)-1===RESERVE_CHANNEL$1.indexOf(" "+sa$2.para.source_channel[s]+" ")&&e.push(sa$2.para.source_channel[s]);sa$2.para.source_channel=e,"number"!=typeof sa$2.para.send_timeout&&(sa$2.para.send_timeout=1e3);var n={send_timeout:6e3,max_length:6};t&&t.datasend_timeout||sa$2.para.batch_send&&(sa$2.para.datasend_timeout=1e4),!0===sa$2.para.batch_send?sa$2.para.batch_send=extend$2({},n):isObject$2(sa$2.para.batch_send)&&(sa$2.para.batch_send=extend$2({},n,sa$2.para.batch_send)),sa$2.para.server_url?sa$2.para.preset_properties=isObject$2(sa$2.para.preset_properties)?sa$2.para.preset_properties:{}:sa$2.log("请使用 setPara() 方法设置 server_url 数据接收地址,详情可查看https://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0")},sa$2.checkInit=function(){!0===sa$2.system.inited&&!0===sa$2.store.inited&&(sa$2.inited=!0,0<sa$2._queue.length)&&(each$2(sa$2._queue,function(t){sa$2[t[0]].apply(sa$2,slice$1.call(t[1]))}),sa$2._queue=[])},each$2(["setProfile","setOnceProfile","track","login","logout","identify","registerApp","clearAppRegister"],function(t){var e=sa$2[t];sa$2[t]=function(){sa$2.inited?e.apply(sa$2,arguments):sa$2._queue.push([t,arguments])}}),{inited:!0,storageInfo:null,_state:{},toState:function(t){isObject$2(t)&&t.distinct_id?this._state=t:this.set("distinct_id",getUUID$1())},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getUnionId:function(){var t={},e=this._state.first_id,r=this._state.distinct_id;return e&&r?(t.login_id=r,t.anonymous_id=e):t.anonymous_id=r,t},getProps:function(){return this._state.props||{}},setProps:function(t,e){var r=this._state.props||{};e?this.set("props",t):(extend$2(r,t),this.set("props",r))},set:function(t,e){var r,s={};for(r in"string"==typeof t?s[t]=e:"object"==typeof t&&(s=t),this._state=this._state||{},s)this._state[r]=s[r];this.save()},save:function(){sa$2.system_api.setStorageSync(sa$2.storageName,this._state)},init:function(){var t,e=sa$2.system_api.getStorageSync(sa$2.storageName);e?this.toState(e):(meta$1.is_first_launch=!0,t=(e=new Date).getTime(),e.setHours(23),e.setMinutes(59),e.setSeconds(60),this.set({distinct_id:getUUID$1(),first_visit_time:t,first_visit_day_time:e.getTime()}),sa$2.setOnceProfile({$first_visit_time:new Date}))}}),system$1=(sa$2.store=store$1,{inited:!1,init:function(){var t=(new Date).getTimezoneOffset(),t=(isNumber$1(t)&&(sa$2.properties.$timezone_offset=t),sa$2.para.app_id||sa$2.para.appid);t&&(sa$2.properties.$app_id=t);try{sa$2.properties.$screen_width=Number(window.screen.width),sa$2.properties.$screen_height=Number(window.screen.height)}catch(t){sa$2.log("获取screen异常")}sa$2.system.inited=!0,sa$2.checkInit()}}),localStorage={get:function(t){return window.localStorage.getItem(t)},parse:function(t){var e;try{e=JSON.parse(this.get(t))||null}catch(t){sa$2.log(t)}return e},set:function(t,e){window.localStorage.setItem(t,e)},remove:function(t){window.localStorage.removeItem(t)},isSupport:function(){var e=!0;try{var t="__sensorsdatasupport__",r="testIsSupportStorage";this.set(t,r),this.get(t)!==r&&(e=!1),this.remove(t)}catch(t){e=!1}return e}};function getStorageSync$1(t){return localStorage.parse(t)}function setStorageSync$1(t,e){var r;try{r=JSON.stringify(e)}catch(t){sa$2.log("序列化缓存对象失败！")}try{localStorage.set(t,r)}catch(t){sa$2.log("set Storage fail!")}}var compose$1={request:function(t){if((t=t||{}).timeout=t.timeout||3e4,!t.method||!t.url)return!1;try{(new Image).src=t.url}catch(t){sa$2.log("创建AJAX请求失败"+t)}},getStorageSync:getStorageSync$1,setStorageSync:setStorageSync$1},sa$1=(sa$2._=_$1,sa$2.para.batch_send=!1,sa$2.system_api=compose$1,sa$2.system=system$1,sa$2.storageName="sd2015-h5-game",{is_first_launch:!(sa$2.properties.$data_ingestion_source=["H5Game"]),launched:!1,_queue:[],mpshow_time:null,sa_referrer:"直接打开",query_share_depth:0,share_distinct_id:"",share_method:"",current_scene:"",inited:!1});sa$1.para={server_url:"",send_timeout:1e3,show_log:!1,allow_amend_share_path:!0,max_string_length:500,datasend_timeout:3e3,source_channel:[],batch_send:{send_timeout:6e3,max_length:6},preset_properties:{}},sa$1.platform="",sa$1.lib={version:"0.12.0",name:"MiniGame",method:"code"},sa$1.properties={$lib:"MiniGame",$lib_version:"0.12.0"},sa$1.currentProps={};const _toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,indexOf=Array.prototype.indexOf,slice=Array.prototype.slice,_isArray=Array.prototype.isArray,forEach=Array.prototype.forEach,bind=Function.prototype.bind;function isUndefined$1(t){return void 0===t}function isString$1(t){return"[object String]"==_toString.call(t)}function isDate$1(t){return"[object Date]"==_toString.call(t)}function isBoolean(t){return"[object Boolean]"==_toString.call(t)}function isNumber(t){return"[object Number]"==_toString.call(t)&&/[\d\\.]+/.test(String(t))}function isJSONString(t){try{JSON.parse(t)}catch(t){return!1}return!0}function isObject$1(t){return null!=t&&"[object Object]"===_toString.call(t)}function isPlainObject(t){return"[object Object]"===_toString.call(t)}function isArray$1(t){return _isArray||"[object Array]"===_toString.call(t)}function isFuction(t){try{return/^\s*\bfunction\b/.test(t)}catch(t){return!1}}function isArguments(t){return!(!t||!_hasOwnProperty.call(t,"callee"))}function toString(t){return null==t?"":isArray$1(t)||isPlainObject(t)&&t.toString===_toString?JSON.stringify(t,null,2):String(t)}function each$1(t,e,r){if(null==t)return!1;if(forEach&&t.forEach===forEach)t.forEach(e,r);else if(t.length===+t.length){for(var s=0,n=t.length;s<n;s++)if(s in t&&e.call(r,t[s],s,t)==={})return!1}else for(var a in t)if(_hasOwnProperty.call(t,a)&&e.call(r,t[a],a,t)==={})return!1}function toArray(t,e){var r;return t?(r=[],t.toArray&&(r=t.toArray()),isArray$1(t)&&(r=slice.call(t)),isArguments(t)&&(r=slice.call(t)),r=values(t),e&&isNumber(e)?r.slice(e):r):[]}function values(t){var e=[];return null!=t&&each$1(t,function(t){e[e.length]=t}),e}function include(t,e){var r=!1;if(null!=t){if(indexOf&&t.indexOf===indexOf)return-1!=t.indexOf(e);each$1(t,function(t){if(r=r||t===e)return{}})}return r}function unique(t){for(var e,r=[],s={},n=0;n<t.length;n++)s[e=t[n]]||(s[e]=!0,r.push(e));return r}function formatDate$1(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())}function searchObjDate$1(r){(isObject$1(r)||isArray$1(r))&&each$1(r,function(t,e){isObject$1(t)||isArray$1(t)?searchObjDate$1(r[e]):isDate$1(t)&&(r[e]=formatDate$1(t))})}function trim(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function isFunction$1(t){return!!t&&("[object Function]"==(t=Object.prototype.toString.call(t))||"[object AsyncFunction]"==t||"[object GeneratorFunction]"==t)}function extend$1(r){return each$1(slice.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&(r[e]=t[e])}),r}function extend2Lev(r){return each$1(slice.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&null!==t[e]&&(isObject$1(t[e])&&isObject$1(r[e])?extend$1(r[e],t[e]):r[e]=t[e])}),r}function isEmptyObject(t){if(isObject$1(t)){for(var e in t)if(_hasOwnProperty.call(t,e))return!1;return!0}return!1}function deepCopy(t){var e={};return function t(e,r){for(var s in r){var n=r[s];isArray$1(n)?(e[s]=[],t(e[s],n)):isObject$1(n)?(e[s]={},t(e[s],n)):e[s]=n}}(e,t),e}function formatString(t){return t.length>sa$1.para.max_string_length?(sa$1.log("字符串长度超过限制，已经做截取--"+t),t.slice(0,sa$1.para.max_string_length)):t}function searchObjString(r){isObject$1(r)&&each$1(r,function(t,e){isObject$1(t)?searchObjString(r[e]):isString$1(t)&&(r[e]=formatString(t))})}function encodeDates(r){return each$1(r,function(t,e){isDate$1(t)?r[e]=formatDate$1(t):isObject$1(t)&&(r[e]=encodeDates(t))}),r}function utf8Encode(t){for(var e,r="",s=e=0,n=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,a=0;a<n;a++){var i=t.charCodeAt(a),o=null;i<128?e++:o=127<i&&i<2048?String.fromCharCode(i>>6|192,63&i|128):String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128),null!==o&&(s<e&&(r+=t.substring(s,e)),r+=o,s=e=a+1)}return s<e&&(r+=t.substring(s,t.length)),r}function base64Encode(t){var e,r,s,n,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,o=0,c="",u=[];if(!t)return t;for(t=utf8Encode(t);e=(n=t.charCodeAt(i++)<<16|t.charCodeAt(i++)<<8|t.charCodeAt(i++))>>12&63,r=n>>6&63,s=63&n,u[o++]=a.charAt(n>>18&63)+a.charAt(e)+a.charAt(r)+a.charAt(s),i<t.length;);switch(c=u.join(""),t.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}function _decodeURIComponent(e){var r="";try{r=decodeURIComponent(e)}catch(t){r=e}return r}var SOURCE_CHANNEL_STANDARD="utm_source utm_medium utm_campaign utm_content utm_term",LATEST_SOURCE_CHANNEL=["$latest_utm_source","$latest_utm_medium","$latest_utm_campaign","$latest_utm_content","$latest_utm_term","$latest_sa_utm"],LATEST_SHARE_INFO=["$latest_share_distinct_id","$latest_share_url_path","$latest_share_depth","$latest_share_method"],IDENTITY_KEY={EMAIL:"$identity_email",MOBILE:"$identity_mobile",LOGIN:"$identity_login_id"},RESERVE_CHANNEL=" utm_source utm_medium utm_campaign utm_content utm_term sa_utm ",meta={lib_version:"",launched:!1,lib_name:"",query_share_depth:0,page_show_time:Date.now(),mp_show_time:null,promise_list:[],current_scene:"",is_first_launch:!1,_queue:[],inited:!1,hasExeInit:!1,scene_prefix:"",share_distinct_id:"",sa_referrer:"直接打开",source_channel_standard:SOURCE_CHANNEL_STANDARD,latest_source_channel:LATEST_SOURCE_CHANNEL,latest_share_info:LATEST_SHARE_INFO};function getAppId(){var t=sa$1.system_api.getAppInfoSync();return t&&t.appId?t.appId:""}function getObjFromQuery(t){var e,t=t.split("?"),r={};return t&&t[1]?(each$1(t[1].split("&"),function(t){(e=t.split("="))[0]&&e[1]&&(r[e[0]]=e[1])}),r):{}}function getMixedQuery(t){var e,t=detectOptionQuery(t),r=t.scene,s=t.q,n=t.query;for(e in n)n[e]=_decodeURIComponent(n[e]);return r&&extend$1(n,getObjFromQuery(r=-1!==(r=_decodeURIComponent(r)).indexOf("?")?"?"+r.replace(/\?/g,""):"?"+r)),s&&extend$1(n,getObjFromQuery(_decodeURIComponent(s))),n}function detectOptionQuery(t){var e,r,s,n;return t&&isObject$1(t.query)?((e={}).query=extend$1({},t.query),isString$1(e.query.scene)&&(r=e.query,s=["utm_source","utm_content","utm_medium","utm_campaign","utm_term","sa_utm"].concat(sa$1.para.source_channel),s=new RegExp("("+s.join("|")+")%3D","i"),1===(n=Object.keys(r)).length)&&"scene"===n[0]&&s.test(r.scene)&&(e.scene=e.query.scene,delete e.query.scene),t.query.q&&t.query.scancode_time&&"101"===String(t.scene).slice(0,3)&&(e.q=String(e.query.q),delete e.query.q,delete e.query.scancode_time),e):{}}function setUtm(t,e){var r={},t=getMixedQuery(t),s=getCustomUtmFromQuery(t,"$","_","$"),t=getCustomUtmFromQuery(t,"$latest_","_latest_","$latest_");return r.pre1=s,r.pre2=t,extend$1(e,s),r}function setLatestChannel(t){isEmptyObject(t)||(!function(t,e){var r,s=!1;for(r in e)t[e[r]]&&(s=!0);return s}(t,LATEST_SOURCE_CHANNEL)||sa$1.clearAppRegister(LATEST_SOURCE_CHANNEL),sa$1.registerApp(t))}function getCustomUtmFromQuery(t,e,r,s){if(!isObject$1(t))return{};var n={};if(t.sa_utm)for(var a in t)"sa_utm"===a?n[s+a]=t[a]:include(sa$1.para.source_channel,a)&&(n[r+a]=t[a]);else for(var i in t)-1!==(" "+SOURCE_CHANNEL_STANDARD+" ").indexOf(" "+i+" ")?n[e+i]=t[i]:include(sa$1.para.source_channel,i)&&(n[r+i]=t[i]);return n}function existLatestUtm(){var e=!1;return each$1(LATEST_SOURCE_CHANNEL,function(t){sa$1.properties[t]&&(e=!0)}),e}function setQuery(t,r){var s;return t&&isObject$1(t)&&!isEmptyObject(t)?(s=[],each$1(t,function(t,e){"q"===e&&isString$1(t)&&0===t.indexOf("http")||s.push(r?e+"="+t:e+"="+_decodeURIComponent(t))}),s.join("&")):""}function getCurrentPage(){var t={};try{var e=isFunction$1(sa$1.system_api.getCurrentPages)?sa$1.system_api.getCurrentPages():getCurrentPages(),t=e[e.length-1]}catch(t){sa$1.log("getCurrentPage:"+t)}return t}function getCurrentPath(){var t="未取到";try{var e=getCurrentPage(),t=e?e.route:t}catch(t){sa$1.log("getCurrentPath:"+t)}return t}function isPresetIdKeys(t,e){var r,s=["$identity_anonymous_id"];for(r of s=isArray$1(e)?s.concat(e):s)if(r===t)return!0;return!1}var isSafeInteger=Number.isSafeInteger||function(t){return isInteger(t)&&Math.abs(t)<=Math.pow(2,53)-1},isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},check={checkKeyword:function(t){return/^((?!^distinct_id$|^original_id$|^device_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_group|^user_tag)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i.test(t)},checkIdLength:function(t){return!(255<String(t).length&&(sa$1.log("id 长度超过 255 个字符！"),1))}};function getOpenidNameByAppid(t){var e,r,s;return""!=t&&isString$1(t)?(r="$identity_",s="_openid",(e=getAppId())?r+t+"_"+e+s:r+t+s):(sa$1.log("error: 参数必须是有效值"),!1)}function validId(t){return!isString$1(t)&&!isNumber(t)||""===t||isNumber(t)&&(t=String(t),!/^\d+$/.test(t))?(sa$1.log("输入 ID 类型错误"),!1):!!check.checkIdLength(t)&&t}function isNewLoginId(t,e){return t!==sa$1.store._state.history_login_id.name||sa$1.store._state.history_login_id.value!==e}function isSameAndAnonymousID(t){var e=sa$1.store.getFirstId(),r=sa$1.store.getDistinctId();return e?t===e:t===r}function setUpperCase(t){return isString$1(t)?t.toLocaleUpperCase():t}function getIsFirstDay(){return!!("object"==typeof sa$1.store._state&&isNumber(sa$1.store._state.first_visit_day_time)&&sa$1.store._state.first_visit_day_time>(new Date).getTime())}function joinUrl(t,e){return!!t&&("未取到"===t?"未取到":e?t+"?"+e:t)}function getPath(t){return t=isString$1(t)?t.replace(/^\//,""):"取值异常"}function getAppProps(t){var e={};return t&&t.path&&(e.$url_path=getPath(t.path),e.$url_query=setQuery(t.query),e.$url=joinUrl(e.$url_path,e.$url_query)),e}function getPageProps(){var t=getCurrentPage(),e=getCurrentPath(),t=t.sensors_mp_url_query||"";return{$url_path:e,$url:joinUrl(e,t),$url_query:t}}function rot13defs(t){return rot13obfs(t=String(t),113)}function rot13obfs(t,e){e="number"==typeof e?e:13;for(var r=(t=String(t)).split(""),s=0,n=r.length;s<n;s++)r[s].charCodeAt(0)<126&&(r[s]=String.fromCharCode((r[s].charCodeAt(0)+e)%126));return r.join("")}var decodeURIComponent$1=_decodeURIComponent;function formatSystem(t){var e=t.toLowerCase();return"ios"===e?"iOS":"android"===e?"Android":t}var getRandomBasic=function(){var e=(new Date).getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();function getRandom(){if("function"==typeof Uint32Array){var t,e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),isObject$1(e)&&e.getRandomValues)return t=new Uint32Array(1),e.getRandomValues(t)[0]/Math.pow(2,32)}return getRandomBasic(1e19)/1e19}function getUUID(){return Date.now()+"-"+Math.floor(1e7*getRandom())+"-"+getRandom().toString(16).replace(".","")+"-"+String(31242*getRandom()).replace(".","").slice(0,8)}const _={getUUID:getUUID,formatSystem:formatSystem,indexOf:indexOf,slice:slice,forEach:forEach,bind:bind,_hasOwnProperty:_hasOwnProperty,_toString:_toString,isUndefined:isUndefined$1,isString:isString$1,isDate:isDate$1,isBoolean:isBoolean,isNumber:isNumber,isJSONString:isJSONString,isObject:isObject$1,isPlainObject:isPlainObject,isArray:isArray$1,isFuction:isFuction,isArguments:isArguments,toString:toString,unique:unique,include:include,values:values,toArray:toArray,each:each$1,formatDate:formatDate$1,searchObjDate:searchObjDate$1,utf8Encode:utf8Encode,decodeURIComponent:decodeURIComponent$1,encodeDates:encodeDates,base64Encode:base64Encode,trim:trim,isFunction:isFunction$1,extend:extend$1,extend2Lev:extend2Lev,isEmptyObject:isEmptyObject,searchObjString:searchObjString,formatString:formatString,setLatestChannel:setLatestChannel,getObjFromQuery:getObjFromQuery,getMixedQuery:getMixedQuery,detectOptionQuery:detectOptionQuery,setUtm:setUtm,getCustomUtmFromQuery:getCustomUtmFromQuery,existLatestUtm:existLatestUtm,setQuery:setQuery,getCurrentPage:getCurrentPage,getCurrentPath:getCurrentPath,rot13defs:rot13defs,rot13obfs:rot13obfs,isSafeInteger:isSafeInteger,isInteger:isInteger,isPresetIdKeys:isPresetIdKeys,deepCopy:deepCopy,check:check,getOpenidNameByAppid:getOpenidNameByAppid,validId:validId,isNewLoginId:isNewLoginId,isSameAndAnonymousID:isSameAndAnonymousID,setUpperCase:setUpperCase,getIsFirstDay:getIsFirstDay,getPageProps:getPageProps,getAppProps:getAppProps,getPath:getPath,joinUrl:joinUrl};function stripProperties(n){return isObject$1(n)&&each$1(n,function(e,r){var s;if(isArray$1(e)&&(s=[],each$1(e,function(t){if(isString$1(t))s.push(t);else if(isUndefined$1(t))s.push("null");else try{s.push(JSON.stringify(t))}catch(t){sa$1.log("您的数据 - "+r+":"+e+" - 的数组里的值有错误,已经将其删除")}}),n[r]=s),isObject$1(e))try{n[r]=JSON.stringify(e)}catch(t){delete n[r],sa$1.log("您的数据 - "+r+":"+e+" - 的数据值有错误,已经将其删除")}else isString$1(e)||isNumber(e)||isDate$1(e)||isBoolean(e)||isArray$1(e)||(sa$1.log("您的数据 - ",e,"-格式不满足要求，我们已经将其删除"),delete n[r])}),n}function parseSuperProperties(r){isObject$1(r)&&each$1(r,function(t,e){if(isFunction$1(t))try{r[e]=t(),isFunction$1(r[e])&&(sa$1.log("您的属性 - "+e+" 格式不满足要求，我们已经将其删除"),delete r[e])}catch(t){delete r[e],sa$1.log("您的属性 - "+e+" 抛出了异常，我们已经将其删除")}})}function batchRequest(t){var e,r;isArray$1(t.data)&&0<t.data.length?(e=Date.now(),r=sa$1.para.datasend_timeout,t.data.forEach(function(t){t._flush_time=e}),t.data=JSON.stringify(t.data),r={url:sa$1.para.server_url,method:"POST",dataType:"text",data:"data_list="+encodeURIComponent(base64Encode(t.data)),timeout:r,success:function(){t.success(t.len)},fail:function(){t.fail()}},sa$1.system_api.request(r)):t.success(t.len)}function onceSend(t){t._flush_time=Date.now();var e="",t=JSON.stringify(t),e=-1!==sa$1.para.server_url.indexOf("?")?sa$1.para.server_url+"&data="+encodeURIComponent(base64Encode(t)):sa$1.para.server_url+"?data="+encodeURIComponent(base64Encode(t)),t=sa$1.para.datasend_timeout;sa$1.system_api.request({url:e,dataType:"text",method:"GET",timeout:t})}var kit={batchRequest:batchRequest,onceSend:onceSend};function batchSend(){var t,e;sa$1.batch_state.sended&&0<(e=(t=100<=(t=sa$1.batch_state.mem).length?t.slice(0,100):t).length)&&(sa$1.batch_state.sended=!1,kit.batchRequest({data:t,len:e,success:batchRemove,fail:sendFail}))}function sendFail(){sa$1.batch_state.sended=!0,sa$1.batch_state.failTime++}function batchRemove(t){sa$1.batch_state.clear(t),sa$1.batch_state.sended=!0,sa$1.batch_state.changed=!0,batchWrite(),sa$1.batch_state.failTime=0}function batchWrite(){sa$1.batch_state.changed&&(sa$1.batch_state.is_first_batch_write&&(sa$1.batch_state.is_first_batch_write=!1,setTimeout(function(){batchSend()},1e3)),sa$1.batch_state.syncStorage)&&(sa$1.system_api.setStorageSync("sensors_prepare_data",sa$1.batch_state.mem),sa$1.batch_state.changed=!1)}function batchInterval(){!function t(){setTimeout(function(){batchWrite(),t()},1e3)}(),function t(){setTimeout(function(){batchSend(),t()},sa$1.para.batch_send.send_timeout*Math.pow(2,sa$1.batch_state.failTime))}()}function reportEvent(t){var e="sensors_",r="";t._flush_time=Date.now(),r=t.event?e+t.event:e+t.type,t.dataSource="sensors",sa$1.log("report_event, name: ",r,"-- key: ",t),__mp_private_api__.reportEvent(r,t)}function isValidListener(t){return"function"==typeof t||!(!t||"object"!=typeof t)&&isValidListener(t.listener)}sa$1.batch_state={mem:[],changed:!1,sended:!0,is_first_batch_write:!0,sync_storage:!1,failTime:0,getLength:function(){return this.mem.length},add:function(t){this.mem.push(t)},clear:function(t){this.mem.splice(0,t)}},sa$1.batchWrite=batchWrite,sa$1.prepareData=function(t){var e={distinct_id:sa$1.store.getDistinctId(),lib:{$lib:sa$1.lib.name,$lib_method:sa$1.lib.method,$lib_version:String(sa$1.lib.version)},properties:{}};if(isObject$1(sa$1.store._state.identities)&&(e.identities=sa$1.store._state.identities),"track_id_unbind"===t.type&&"$UnbindID"===t.event&&(e.identities=deepCopy(t.unbind_value),delete t.unbind_value),e=extend$1(e,sa$1.store.getUnionId(),t),isObject$1(t.properties)&&!isEmptyObject(t.properties)&&(e.properties=extend$1(e.properties,t.properties)),t.type&&"profile"===t.type.slice(0,7)||(e._track_id=Number(String(getRandom()).slice(2,5)+String(getRandom()).slice(2,4)+String(Date.now()).slice(-4)),e.properties=extend$1({},sa$1.properties,sa$1.store.getProps(),sa$1.currentProps,e.properties),"track"===t.type&&(e.properties.$is_first_day=getIsFirstDay())),e.properties.$time&&isDate$1(e.properties.$time)?(e.time=+e.properties.$time,delete e.properties.$time):e.time=+new Date,sa$1.ee.data.emit("beforeBuildCheck",e),parseSuperProperties(e.properties),searchObjDate$1(e),stripProperties(e.properties),searchObjString(e),sa$1.ee.data.emit("finalAdjustData",e),!sa$1.para.server_url)return!1;sa$1.log(e),sa$1.send(e)},sa$1.send=function(t){if(t._nocache=(String(getRandom())+String(getRandom())+String(getRandom())).slice(2,15),"sensorsdata2015_binance"===sa$1.storageName&&"native"===sa$1.para.data_report_type)return reportEvent(t),!1;sa$1.para.batch_send?(500<=sa$1.batch_state.getLength()&&(sa$1.log("数据量存储过大，有异常"),sa$1.batch_state.mem.shift()),sa$1.batch_state.add(t),sa$1.batch_state.changed=!0,sa$1.batch_state.getLength()>=sa$1.para.batch_send.max_length&&batchSend()):kit.onceSend(t)},sa$1.log=function(){if(sa$1.para.show_log&&"object"==typeof console&&console.log)try{var t=Array.prototype.slice.call(arguments);return console.log.apply(console,t)}catch(t){console.log(arguments[0])}},sa$1.track=function(t,e,r){sa$1.prepareData({type:"track",event:t,properties:e},r)},sa$1.setProfile=function(t){sa$1.prepareData({type:"profile_set",properties:t})},sa$1.setOnceProfile=function(t,e){sa$1.prepareData({type:"profile_set_once",properties:t},e)},sa$1.login=function(t){var e=sa$1.store.getFirstId(),r=sa$1.store.getDistinctId();t!==r&&(e||sa$1.store.set("first_id",r),sa$1.trackSignup(t,"$SignUp"))},sa$1.logout=function(t){var e=sa$1.store.getFirstId();e?(sa$1.store.set("first_id",""),!0===t?sa$1.store.set("distinct_id",getUUID()):sa$1.store.set("distinct_id",e)):sa$1.log("没有first_id，logout失败")},sa$1.identify=function(t){if("number"==typeof t)t=String(t);else if("string"!=typeof t)return!1;sa$1.store.getFirstId()?sa$1.store.set("first_id",t):sa$1.store.set("distinct_id",t)},sa$1.trackSignup=function(t,e,r){var s,n,a;isObject$1(t)?(s=t.id,n=t.event_name,a=t.id_name):(s=t,n=e),sa$1.store.set("distinct_id",s),t=a&&a!==IDENTITY_KEY.LOGIN?a+"+"+s:s,e=sa$1.store.getFirstId()||sa$1.store.getDistinctId(),sa$1.prepareData({original_id:e,distinct_id:t,type:"track_signup",event:n,properties:r})},sa$1.registerApp=function(t){isObject$1(t)&&!isEmptyObject(t)&&(sa$1.currentProps=extend$1(sa$1.currentProps,t))},sa$1.clearAppRegister=function(r){isArray$1(r)&&each$1(sa$1.currentProps,function(t,e){include(r,e)&&delete sa$1.currentProps[e]})},sa$1.register=function(t){isObject$1(t)&&!isEmptyObject(t)&&sa$1.store.setProps(t)},sa$1.clearAllRegister=function(){sa$1.store.setProps({},!0)},sa$1.use=function(t){var e=toArray(arguments,1);return e.unshift(this),isObject$1(t)&&isFunction$1(t.init)&&t.init.apply(t,e),t},sa$1.usePlugin=sa$1.use,sa$1.getServerUrl=function(){return sa$1.para.server_url},sa$1.registerPropertyPlugin=function(e){isFunction$1(e.properties)?e.isMatchedWithFilter&&!isFunction$1(e.isMatchedWithFilter)?sa$1.log("registerPropertyPlugin arguments error, isMatchedWithFilter must be function"):sa$1.ee.data.on("finalAdjustData",function(t){try{(!isFunction$1(e.isMatchedWithFilter)||e.isMatchedWithFilter(t))&&e.properties(t)}catch(t){sa$1.log("execute registerPropertyPlugin callback error:"+t)}}):sa$1.log("registerPropertyPlugin arguments error, properties must be function")};class EventEmitterBase{constructor(){this._events={}}on(t,e){if(!t||!e)return!1;if(isValidListener(e))return this._events[t]=this._events[t]||[],this._events[t].push("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prepend(t,e){if(!t||!e)return!1;if(isValidListener(e))return this._events[t]=this._events[t]||[],this._events[t].unshift("object"==typeof e?e:{listener:e,once:!1}),this;throw new Error("listener must be a function")}prependOnce(t,e){return this.prepend(t,{listener:e,once:!0})}once(t,e){return this.on(t,{listener:e,once:!0})}off(t,e){var r=this._events[t];if(!r)return!1;if("number"==typeof e)r.splice(e,1);else if("function"==typeof e)for(var s=0,n=r.length;s<n;s++)r[s]&&r[s].listener===e&&r.splice(s,1);return this}emit(t,e){var r=this._events[t];if(!r)return!1;for(var s=0;s<r.length;s++){var n=r[s];n&&(n.listener.call(this,e||{}),n.once)&&this.off(t,s)}return this}removeAllListeners(t){t&&this._events[t]?this._events[t]=[]:this._events={}}listeners(t){return t&&"string"==typeof t?this._events[t]:this._events}}class EventEmitterEx extends EventEmitterBase{constructor(){super(),this.cacheEvents=[],this.maxLen=20}replay(e,r){this.on(e,r),0<this.cacheEvents.length&&this.cacheEvents.forEach(function(t){t.type===e&&r.call(null,t.data)})}emit(t,e){super.emit.apply(this,arguments),this.cacheEvents.push({type:t,data:e}),this.cacheEvents.length>this.maxLen&&this.cacheEvents.shift()}}var ee={},eventEmitter=(ee.sdk=new EventEmitterEx,ee.data=new EventEmitterEx,function(){this.sub=[]}),eventSub=(eventEmitter.prototype={add:function(t){this.sub.push(t)},emit:function(e,r){this.sub.forEach(function(t){t.on(e,r)})}},function(t){sa$1.events.add(this),this._events=[],this.handle=t,this.ready=!1}),store=(eventSub.prototype={on:function(t,e){if(this.ready){if(isFunction$1(this.handle))try{this.handle(t,e)}catch(t){sa$1.log(t)}}else this._events.push({event:t,data:e})},isReady:function(){var e=this;e.ready=!0,e._events.forEach(function(t){if(isFunction$1(e.handle))try{e.handle(t.event,t.data)}catch(t){sa$1.log(t)}})}},sa$1.ee=ee,sa$1.meta=meta,sa$1.kit=kit,sa$1.modules={},sa$1.eventSub=eventSub,sa$1.events=new eventEmitter,sa$1.init=function(t){if(!0===meta.hasExeInit)return!1;t&&isObject$1(t)&&sa$1.setPara(t),meta.hasExeInit=!0,t&&isObject$1(t)&&sa$1.setPara(t),ee.sdk.emit("afterInitPara"),sa$1.store.init(),sa$1.system.init(),sa$1.para.batch_send&&(sa$1.system_api.getStorage("sensors_prepare_data",function(t){var e=[];t&&t.data&&isArray$1(t.data)&&(e=t.data,sa$1.batch_state.mem=e.concat(sa$1.batch_state.mem)),sa$1.batch_state.syncStorage=!0}),batchInterval())},sa$1.setPara=function(t){sa$1.para=extend2Lev(sa$1.para,t);var e=[];if(isArray$1(sa$1.para.source_channel))for(var r=sa$1.para.source_channel.length,s=0;s<r;s++)-1===RESERVE_CHANNEL.indexOf(" "+sa$1.para.source_channel[s]+" ")&&e.push(sa$1.para.source_channel[s]);sa$1.para.source_channel=e,"number"!=typeof sa$1.para.send_timeout&&(sa$1.para.send_timeout=1e3);var n={send_timeout:6e3,max_length:6};t&&t.datasend_timeout||sa$1.para.batch_send&&(sa$1.para.datasend_timeout=1e4),!0===sa$1.para.batch_send?sa$1.para.batch_send=extend$1({},n):isObject$1(sa$1.para.batch_send)&&(sa$1.para.batch_send=extend$1({},n,sa$1.para.batch_send)),sa$1.para.server_url?sa$1.para.preset_properties=isObject$1(sa$1.para.preset_properties)?sa$1.para.preset_properties:{}:sa$1.log("请使用 setPara() 方法设置 server_url 数据接收地址,详情可查看https://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0")},sa$1.checkInit=function(){!0===sa$1.system.inited&&!0===sa$1.store.inited&&(sa$1.inited=!0,0<sa$1._queue.length)&&(each$1(sa$1._queue,function(t){sa$1[t[0]].apply(sa$1,slice.call(t[1]))}),sa$1._queue=[])},each$1(["setProfile","setOnceProfile","track","login","logout","identify","registerApp","clearAppRegister"],function(t){var e=sa$1[t];sa$1[t]=function(){sa$1.inited?e.apply(sa$1,arguments):sa$1._queue.push([t,arguments])}}),{inited:!0,storageInfo:null,_state:{},toState:function(t){isObject$1(t)&&t.distinct_id?this._state=t:this.set("distinct_id",getUUID())},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getUnionId:function(){var t={},e=this._state.first_id,r=this._state.distinct_id;return e&&r?(t.login_id=r,t.anonymous_id=e):t.anonymous_id=r,t},getProps:function(){return this._state.props||{}},setProps:function(t,e){var r=this._state.props||{};e?this.set("props",t):(extend$1(r,t),this.set("props",r))},set:function(t,e){var r,s={};for(r in"string"==typeof t?s[t]=e:"object"==typeof t&&(s=t),this._state=this._state||{},s)this._state[r]=s[r];this.save()},save:function(){sa$1.system_api.setStorageSync(sa$1.storageName,this._state)},init:function(){var t,e=sa$1.system_api.getStorageSync(sa$1.storageName);e?this.toState(e):(meta.is_first_launch=!0,t=(e=new Date).getTime(),e.setHours(23),e.setMinutes(59),e.setSeconds(60),this.set({distinct_id:getUUID(),first_visit_time:t,first_visit_day_time:e.getTime()}),sa$1.setOnceProfile({$first_visit_time:new Date}))}});function getNetwork(){return new Promise(function(t){sa$1.system_api.getNetworkType({success(t){sa$1.properties.$network_type=setUpperCase(t.networkType)},fail(t){sa$1.log("获取网络状态信息失败： ",t)},complete(){t()}})})}function getSystemInfo(){return new Promise(t=>{sa$1.system_api.getSystemInfo({success(t){var e=sa$1.properties;isObject$1(t)&&(e.$manufacturer=t.brand,e.$model=t.model,e.$brand=setUpperCase(t.brand)||"",e.$screen_width=Number(t.screenWidth),e.$screen_height=Number(t.screenHeight),e.$os=formatSystem(t.platform),e.$os_version=-1<t.system.indexOf(" ")?t.system.split(" ")[1]:t.system,e.$mp_client_app_version=t.version||"",t=t.SDKVersion||"")&&(e.$mp_client_basic_library_version=t)},fail(t){sa$1.log("获取系统信息失败: ",t)},complete(){t()}})})}sa$1.store=store;var system={inited:!1,init:function(){var t=(new Date).getTimezoneOffset(),t=(isNumber(t)&&(sa$1.properties.$timezone_offset=t),getAppId()||sa$1.para.app_id||sa$1.para.appid),t=(t&&(sa$1.properties.$app_id=t),getNetwork()),e=getSystemInfo();Promise.all([t,e]).then(function(){sa$1.system.inited=!0,sa$1.checkInit()})}};function request(t){t.timeout&&(e=t.timeout,delete t.timeout);var e,r=sa$1.platform_obj.request(t);setTimeout(function(){try{isObject$1(r)&&isFunction$1(r.abort)&&r.abort()}catch(t){sa$1.log(t)}},e)}function getStorage(e,r){try{sa$1.platform_obj.getStorage({key:e,success:s,fail:s})}catch(t){try{sa$1.platform_obj.getStorage({key:e,success:s,fail:s})}catch(t){sa$1.log("获取 storage 失败！",t)}}function s(t){if(t&&t.data&&isJSONString(t.data))try{var e=JSON.parse(t.data);t.data=e}catch(t){sa$1.log("parse res.data 失败！",t)}r(t)}}function setStorage(e,t){var r;try{r=JSON.stringify(t)}catch(t){sa$1.log("序列化缓存对象失败！",t)}try{sa$1.platform_obj.setStorage({key:e,data:r})}catch(t){try{sa$1.platform_obj.setStorage({key:e,data:r})}catch(t){sa$1.log("设置 storage 失败: ",t)}}}function getStorageSync(e){var r="";try{r=sa$1.platform_obj.getStorageSync(e)}catch(t){try{r=sa$1.platform_obj.getStorageSync(e)}catch(t){sa$1.log("获取 storage 失败！")}}return r=isJSONString(r)?JSON.parse(r):r}function setStorageSync(t,e){var r;try{r=JSON.stringify(e)}catch(t){sa$1.log("序列化缓存对象失败！",t)}function s(){sa$1.platform_obj.setStorageSync(t,r)}try{s()}catch(t){sa$1.log("set Storage fail --",t);try{s()}catch(t){sa$1.log("set Storage fail again --",t)}}}function getNetworkType(){return sa$1.platform_obj.getNetworkType.apply(null,arguments)}function getSystemInfo$1(){return sa$1.platform_obj.getSystemInfo.apply(null,arguments)}function getAppId$1(){var t;if(isObject$1(t=sa$1.platform_obj.getAccountInfoSync?sa$1.platform_obj.getAccountInfoSync():t)&&isObject$1(t.miniProgram))return t.miniProgram}var compose={request:request,getStorage:getStorage,setStorage:setStorage,getStorageSync:getStorageSync,setStorageSync:setStorageSync,getAppInfoSync:getAppId$1,getNetworkType:getNetworkType,getSystemInfo:getSystemInfo$1};sa$1._=_,sa$1.system=system,sa$1.system_api=compose,sa$1.storageName="sd2015-bytedance-game",sa$1.properties.$data_ingestion_source=["BytedanceGame"],"undefined"!=typeof tt&&(sa$1.platform_obj=tt);class PlatformProxy{static createInstance(){return Laya.Browser.onMiniGame?sa$3:Laya.Browser.onQQMiniGame?sa$4:Laya.Browser.onTTMiniGame?sa$1:sa$2}}function androidApi(r){return{init:function(t){r.call("initSDK",t)},track:function(t,e){r.call("track",t,e)},login:function(t){r.call("login",t)},logout:function(){r.call("logout")},identify:function(t){r.call("identify",t)},registerApp:function(t){r.call("registerApp",t)},clearAppRegister:function(t){r.call("clearAppRegister",t)},setProfile:function(t){r.call("setProfile",t)},setOnceProfile:function(t){r.call("setOnceProfile",t)},trackAppInstall:function(t){r.call("trackAppInstall",t)},flush:function(){r.call("flush")},getPresetProperties:function(e){r.callWithBack(function(t){e(t)},"getPresetProperties")},deleteAll:function(){r.call("deleteAll")}}}function iosApi(r){return{init:function(t){r.call("initSDK:",t)},track:function(t,e){r.call("track:properties:",t,e)},login:function(t){r.call("login:",t)},logout:function(){r.call("logout")},identify:function(t){r.call("identify:",t)},registerApp:function(t){r.call("registerApp:",t)},clearAppRegister:function(t){r.call("clearAppRegister:",t)},setProfile:function(t){r.call("setProfile:",t)},setOnceProfile:function(t){r.call("setOnceProfile:",t)},trackAppInstall:function(t){r.call("trackAppInstall:",t)},flush:function(){r.call("flush")},getPresetProperties:function(e){r.callWithBack(function(t){e(t)},"getPresetProperties")},deleteAll:function(){r.call("deleteAll")}}}function isFunction(t){return!!t&&("[object Function]"==(t=Object.prototype.toString.call(t))||"[object AsyncFunction]"==t)}function isObject(t){return null!=t&&"[object Object]"==Object.prototype.toString.call(t)}function isString(t){return"[object String]"==Object.prototype.toString.call(t)}function isUndefined(t){return void 0===t}function isArray(t){return Array.isArray&&isFunction(isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}(new Date).getTime();var nativeForEach=Array.prototype.forEach,hasOwnProperty$2=Object.prototype.hasOwnProperty;function each(t,e,r){if(null==t)return!1;if(nativeForEach&&t.forEach===nativeForEach)t.forEach(e,r);else if(isArray(t))for(var s=0,n=t.length;s<n;s++)s in t&&e.call(r,t[s],s,t);else for(var a in t)hasOwnProperty$2.call(t,a)&&e.call(r,t[a],a,t)}var hasOwnProperty$1=Object.prototype.hasOwnProperty;function extend(r){return each(Array.prototype.slice.call(arguments,1),function(t){for(var e in t)hasOwnProperty$1.call(t,e)&&void 0!==t[e]&&(r[e]=t[e])}),r}function isDate(t){return"[object Date]"==Object.prototype.toString.call(t)}function formatDate(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())}function searchObjDate(r){(isObject(r)||isArray(r))&&each(r,function(t,e){isObject(t)||isArray(t)?searchObjDate(r[e]):isDate(t)&&(r[e]=formatDate(t))})}class AutoTrack{constructor(t,e,r){this.saInstance=t,this.config=e||{},this.appShow(),this.startShow=!0,isObject(r)&&isFunction(r.onShow)&&(r.onShow(()=>{this.appShow()}),r.onHide(()=>{this.startShow=!1,this.config.autoTrack.app_hide&&this.saInstance.track("$MPHide")}))}appShow(){this.startShow||this.config.autoTrack.app_show&&this.saInstance.track("$MPShow")}}var sa={},COMMON_API_LIST=["track","login","logout","identify","register","clearRegister","setProfile","setOnceProfile","trackAppInstall","flush","getPresetProperties","deleteAll"];COMMON_API_LIST.forEach(function(t){sa[t]=function(){return console.log(`[sensors log]：${t} 该方法暂未定义`),!1}});const DEFAULT_CONFIG={server_url:"",show_log:!1,super_properties:{},mini:{app_show:!1,app_hide:!1,datasend_timeout:3e3,send_timeout:1e3,batch_send:{send_timeout:6e3,max_length:6}},app:{app_start:!1,app_end:!1}};var is_add_lib_plugin_version=!0;const laya_version="laya:0.0.1";class SensorsDataAPI{constructor(){this._init()}_isNativePlatform(){return!(isUndefined(this.nativeProxy)||!this._isIOS()&&!this._isAndroid())}_isIOS(){return"Conch-ios"===conchConfig.getOS()}_isAndroid(){return"Conch-android"===conchConfig.getOS()}_init(){try{this._isIOS()?this.nativeProxy=PlatformClass.createClass("SensorsAnalyticsLayaModule"):this._isAndroid()&&(this.nativeProxy=PlatformClass.createClass("demo.SensorsAnalyticsLayaModule"))}catch(t){this._isNativePlatform()&&console.log("原生 Class 创建失败 = "+t,"warn")}finally{this._isNativePlatform()&&this._initInstanceForNative()}}log(t,e){this.config.show_log&&console.log("%c[sensors log]："+t,{info:"color: #3B82F6;",error:"color: #EF4444",warn:"color: #F59E0B",success:"color: #04cb94"}[e]||"")}init(t){if(isObject(t)?this.config=extend({},DEFAULT_CONFIG,t):this.config=DEFAULT_CONFIG,""==this.config.server_url)return this.log("请设置 server_url 数据接收地址","warn"),!1;this._isNativePlatform()?(this.log("sdk 初始化成功","success"),isObject(this.config.super_properties)&&searchObjDate(this.config.super_properties),this.platform.init(this.config)):(this.saJs=PlatformProxy.createInstance(),isObject(this.saJs)?this._initInstanceForJs():this.log("初始化失败，暂不支持当前小游戏","error"))}_initInstanceForJs(){var t=this.config,t=extend({},{server_url:t.server_url,show_log:t.show_log,super_properties:t.super_properties,autoTrack:{app_show:t.mini.app_show,app_hide:t.mini.app_hide}},t.mini);this.saJs.setPara(t),this._setSuperProperties(this.saJs,t.super_properties),this.saJs.init(),t.autoTrack&&"sd2015-h5-game"!==this.saJs.storageName&&new AutoTrack(this,t,this.saJs.platform_obj),this.log("sdk 初始化成功","success")}_initInstanceForNative(){this._isIOS()?this.platform=iosApi(this.nativeProxy):this._isAndroid()&&(this.platform=androidApi(this.nativeProxy))}_setSuperProperties(t,e){isObject(e)?t.currentProps=extend({},t.currentProps,e):this.log("setSuperProperties 参数必须为有效的属性值","warn")}paraCheck(t){return!t||0==t.length||(this.log("API 调用失败，参数异常！","warn"),!1)}track(t,e={}){return isString(t)?isObject(e)?(is_add_lib_plugin_version&&(is_add_lib_plugin_version=!1,e=extend({},e,{$lib_plugin_version:[laya_version]})),void(this._isNativePlatform()?(searchObjDate(e),this.platform):this.saJs).track(t,e)):(this.log("请传入正确的数据类型！","warn"),!1):(this.log("传入的事件名称不是一个合法的字符串！","warn"),!1)}login(t){if(!isString(t))return this.log("传入的 id 不是一个合法的字符串！","warn"),!1;(this._isNativePlatform()?this.platform:this.saJs).login(t)}logout(){this._isNativePlatform()?this.paraCheck(arguments)&&this.platform.logout():this.saJs.logout()}identify(t){if("number"==typeof t)t=String(t);else if("string"!=typeof t)return this.log("传入的 id 参数类型错误！","warn"),!1;(this._isNativePlatform()?this.platform:this.saJs).identify(t)}register(t){if(!isObject(t))return this.log("register 参数类型错误！","warn"),!1;(this._isNativePlatform()?(searchObjDate(t),this.platform):this.saJs).registerApp(t)}clearRegister(t){if(!isArray(t))return this.log("clearRegister 参数类型错误！","warn"),!1;if(this._isNativePlatform())for(var e in t)isString(t[e])?this.platform.clearAppRegister(t[e]):this.log("clearRegister 参数类型错误！","warn");else this.saJs.clearAppRegister(t)}setProfile(t){if(!isObject(t))return this.log("setProfile 参数类型错误！","warn"),!1;(this._isNativePlatform()?(searchObjDate(t),this.platform):this.saJs).setProfile(t)}setOnceProfile(t){if(!isObject(t))return this.log("setOnceProfile 参数类型错误！","warn"),!1;(this._isNativePlatform()?(searchObjDate(t),this.platform):this.saJs).setOnceProfile(t)}trackAppInstall(t={}){this._isNativePlatform()?isObject(t)?(searchObjDate(t),this.platform.trackAppInstall(t)):this.log("trackAppInstall 参数类型错误！","warn"):this.log("trackAppInstall API 暂不支持","warn")}flush(){this._isNativePlatform()?this.paraCheck(arguments)&&this.platform.flush():this.log("flush API 暂不支持","warn")}getPresetProperties(t){if(!isUndefined(t)&&this._isNativePlatform())return this.platform.getPresetProperties(t);this.log("getPresetProperties API 暂不支持","warn")}deleteAll(){this._isNativePlatform()?this.paraCheck(arguments)&&this.platform.deleteAll():this.log("deleteAll API 暂不支持","warn")}}var saDataAPI=new SensorsDataAPI,initApi=function(){COMMON_API_LIST.forEach(t=>{isFunction(saDataAPI[t])&&(sa[t]=saDataAPI[t].bind(saDataAPI))})};sa.init=function(t){saDataAPI.init(t),initApi()},window.sensorsDataAPI=sa,module.exports=sa;
